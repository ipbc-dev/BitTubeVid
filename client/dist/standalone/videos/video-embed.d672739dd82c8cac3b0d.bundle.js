!function(e){function t(t){for(var n,i,r=t[0],a=t[1],s=0,d=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(l&&l(t);d.length;)d.shift()()}var n={},o={6:0};function i(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise((function(t,i){n=o[e]=[t,i]}));t.push(n[2]=r);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+""+e+".chunk.js"}(e);var l=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(d);var n=o[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",l.name="ChunkLoadError",l.type=i,l.request=r,n[1](l)}o[e]=void 0}};var d=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/client/standalone/videos/",i.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp=window.webpackJsonp||[],a=r.push.bind(r);r.push=t,r=r.slice();for(var s=0;s<r.length;s++)t(r[s]);var l=a;i(i.s=177)}({15:function(e,t,n){e.exports=function(){"use strict";return function(){var e=Math.floor(1000001*Math.random()),t={};function n(e){return Array.isArray?Array.isArray(e):-1!=e.constructor.toString().indexOf("Array")}var o={},i=function(e){try{var n=JSON.parse(e.data);if("object"!=typeof n||null===n)throw"malformed"}catch(e){return}var i,r,a,s=e.source,l=e.origin;if("string"==typeof n.method){var d=n.method.split("::");2==d.length?(i=d[0],a=d[1]):a=n.method}if(void 0!==n.id&&(r=n.id),"string"==typeof a){var c=!1;if(t[l]&&t[l][i])for(var u=0;u<t[l][i].length;u++)if(t[l][i][u].win===s){t[l][i][u].handler(l,a,n),c=!0;break}if(!c&&t["*"]&&t["*"][i])for(u=0;u<t["*"][i].length;u++)if(t["*"][i][u].win===s){t["*"][i][u].handler(l,a,n);break}}else void 0!==r&&o[r]&&o[r](l,a,n)};return window.addEventListener?window.addEventListener("message",i,!1):window.attachEvent&&window.attachEvent("onmessage",i),{build:function(i){var r=function(e){if(i.debugOutput&&window.console&&window.console.log){try{"string"!=typeof e&&(e=JSON.stringify(e))}catch(e){}window.console.log("["+l+"] "+e)}};if(!window.postMessage)throw"jschannel cannot run this browser, no postMessage";if(!window.JSON||!window.JSON.stringify||!window.JSON.parse)throw"jschannel cannot run this browser, no JSON parsing/serialization";if("object"!=typeof i)throw"Channel build invoked without a proper object argument";if(!i.window||!i.window.postMessage)throw"Channel.build() called without a valid window argument";window===i.window&&r("target window is same as present window -- use at your own risk");var a,s=!1;if("string"==typeof i.origin&&("*"===i.origin?s=!0:null!==(a=i.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))&&(i.origin=a[0].toLowerCase(),s=!0)),!s)throw"Channel.build() called with an invalid origin";if(void 0!==i.scope){if("string"!=typeof i.scope)throw"scope, when specified, must be a string";if(i.scope.split("::").length>1)throw"scope may not contain double colons: '::'"}else i.scope="__default";var l=function(){for(var e="",t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n=0;n<5;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}(),d={},c={},u={},h=!1,p=[],m=[],f=function(e,t,a){if("function"==typeof i.gotMessageObserver)try{i.gotMessageObserver(e,a)}catch(e){r("gotMessageObserver() raised an exception: "+e.toString())}if(a.id&&t){u[a.id]={};var s=function(e,t,n){var o=!1,i=!1;return{origin:t,invoke:function(t,o){if(!u[e])throw"attempting to invoke a callback of a nonexistent transaction: "+e;for(var i=!1,r=0;r<n.length;r++)if(t===n[r]){i=!0;break}if(!i)throw"request supports no such callback '"+t+"'";g({id:e,callback:t,params:o})},error:function(t,n){if(i=!0,!u[e])throw"error called for nonexistent message: "+e;delete u[e],g({id:e,error:t,message:n})},complete:function(t){if(i=!0,!u[e])throw"complete called for nonexistent message: "+e;delete u[e],g({id:e,result:t})},delayReturn:function(e){return"boolean"==typeof e&&(o=!0===e),o},completed:function(){return i}}}(a.id,e,a.callbacks?a.callbacks:[]);if(d[t])try{if(a.callbacks&&n(a.callbacks)&&a.callbacks.length>0)for(var l=0;l<a.callbacks.length;l++){for(var h=a.callbacks[l],p=a.params,m=h.split("/"),f=0;f<m.length-1;f++){var E=m[f];"object"!=typeof p[E]&&(p[E]={}),p=p[E]}p[m[m.length-1]]=function(){var e=h;return function(t){return s.invoke(e,t)}}()}var b=d[t](s,a.params);s.delayReturn()||s.completed()||s.complete(b)}catch(e){var y="runtime_error",_=null;if("string"==typeof e?_=e:"object"==typeof e&&(e instanceof Error?(y=e.constructor.name,_=e.message):e&&n(e)&&2==e.length?(y=e[0],_=e[1]):"string"==typeof e.error&&(y=e.error,e.message?"string"==typeof e.message?_=e.message:e=e.message:_="")),null===_)try{void 0===(_=JSON.stringify(e))&&(_=e.toString())}catch(t){_=e.toString()}s.error(y,_)}else s.error("method_not_found","No method '"+t+"' was (yet) bound by the provider")}else a.id&&a.callback?c[a.id]&&c[a.id].callbacks&&c[a.id].callbacks[a.callback]?c[a.id].callbacks[a.callback](a.params):r("ignoring invalid callback, id:"+a.id+" ("+a.callback+")"):a.id?c[a.id]?(a.error?c[a.id].error&&c[a.id].error(a.error,a.message):void 0!==a.result?c[a.id].success(a.result):c[a.id].success(),delete c[a.id],delete o[a.id]):r("ignoring invalid response: "+a.id):t&&d[t]&&d[t]({origin:e},a.params)};!function(e,n,o,i){function r(t){for(var n=0;n<t.length;n++)if(t[n].win===e)return!0;return!1}var a=!1;if("*"===n){for(var s in t)if(t.hasOwnProperty(s)&&"*"!==s&&"object"==typeof t[s][o]&&(a=r(t[s][o])))break}else t["*"]&&t["*"][o]&&(a=r(t["*"][o])),!a&&t[n]&&t[n][o]&&(a=r(t[n][o]));if(a)throw"A channel is already bound to the same window which overlaps with origin '"+n+"' and has scope '"+o+"'";"object"!=typeof t[n]&&(t[n]={}),"object"!=typeof t[n][o]&&(t[n][o]=[]),t[n][o].push({win:e,handler:i})}(i.window,i.origin,i.scope,f);var E=function(e){return[i.scope,e].join("::")},g=function(e,t){if(!e)throw"postMessage called with null message";if(t||h){if("function"==typeof i.postMessageObserver)try{i.postMessageObserver(i.origin,e)}catch(e){r("postMessageObserver() raised an exception: "+e.toString())}r("post message: "+JSON.stringify(e)+" with origin "+i.origin),i.window.postMessage(JSON.stringify(e),i.origin)}else r("queue message: "+JSON.stringify(e)),p.push(e)},b=function(e,t){var n;e=[].concat(e);for(var o=0;o<e.length;o++)t[n=e[o].toString()]=function(e){return function(t,n,o){n?y.call({method:e,params:t,success:n,error:o}):y.notify({method:e,params:t})}}(n)},y={remote:{},unbind:function(e,t){if(d[e]){if(!delete d[e])throw"can't delete method: "+e;return i.publish&&!t&&(h?y.notify({method:"__unbind",params:e}):m.push({action:"unbind",method:e})),!0}return!1},bind:function(e,t,n){if(!e||"string"!=typeof e)throw"'method' argument to bind must be string";if(!t||"function"!=typeof t)throw"callback missing from bind params";if(d[e])throw"method '"+e+"' is already bound!";return d[e]=t,i.publish&&!n&&(h?y.notify({method:"__bind",params:e}):m.push({action:"bind",method:e})),this},call:function(t){if(!t)throw"missing arguments to call function";if(!t.method||"string"!=typeof t.method)throw"'method' argument to call must be string";if(!t.success||"function"!=typeof t.success)throw"'success' callback missing from call";var n={},i=[],r=[],a=function(e,t){if(r.indexOf(t)>=0)throw"params cannot be a recursive data structure";if(t&&r.push(t),"object"==typeof t)for(var o in t)if(t.hasOwnProperty(o)){var s=e+(e.length?"/":"")+o;"function"==typeof t[o]?(n[s]=t[o],i.push(s),delete t[o]):"object"==typeof t[o]&&a(s,t[o])}};a("",t.params);var s,l,d,u={id:e,method:E(t.method),params:t.params};i.length&&(u.callbacks=i),t.timeout&&(s=e,l=t.timeout,d=E(t.method),window.setTimeout((function(){c[s]&&(c[s].error&&c[s].error("timeout_error","timeout ("+l+"ms) exceeded on method '"+d+"'"),delete c[s],delete o[s])}),l)),c[e]={callbacks:n,error:t.error,success:t.success},o[e]=f,e++,g(u)},notify:function(e){if(!e)throw"missing arguments to notify function";if(!e.method||"string"!=typeof e.method)throw"'method' argument to notify must be string";g({method:E(e.method),params:e.params})},destroy:function(){!function(e,n,o){for(var i=t[n][o],r=0;r<i.length;r++)i[r].win===e&&i.splice(r,1);0===t[n][o].length&&delete t[n][o]}(i.window,i.origin,i.scope),window.removeEventListener?window.removeEventListener("message",f,!1):window.detachEvent&&window.detachEvent("onmessage",f),h=!1,d={},u={},c={},i.origin=null,p=[],r("channel destroyed"),l=""}};return y.bind("__ready",(function(e,t){if(r("ready msg received"),h&&!i.reconnect)throw"received ready message while in ready state.";h=!0,l.length<6&&(l+="publish-request"===t.type?"-R":"-L"),r("ready msg accepted."),"publish-request"===t.type&&y.notify({method:"__ready",params:{type:"publish-reply",publish:m}});for(var n=0;n<t.publish.length;n++)"bind"===t.publish[n].action?b([t.publish[n].method],y.remote):delete y.remote[t.publish[n].method];for(i.reconnect||y.unbind("__ready",!0);p.length;)g(p.splice(0,1)[0]);m=[],"function"==typeof i.onReady&&i.onReady(y)}),!0),y.bind("__bind",(function(e,t){b([t],y.remote)}),!0),y.bind("__unbind",(function(e,t){y.remote[t]&&delete y.remote[t]}),!0),i.remote&&b(i.remote,y.remote),setTimeout((function(){l.length>0&&g({method:E("__ready"),params:{type:"publish-request",publish:m}},!0)}),0),y}}}()}()},16:function(e,t,n){"use strict";var o,i,r,a,s,l,d,c,u,h,p,m,f,E,g;!function(e){e[e.NEW_VIDEO_FROM_SUBSCRIPTION=1]="NEW_VIDEO_FROM_SUBSCRIPTION",e[e.NEW_COMMENT_ON_MY_VIDEO=2]="NEW_COMMENT_ON_MY_VIDEO",e[e.NEW_VIDEO_ABUSE_FOR_MODERATORS=3]="NEW_VIDEO_ABUSE_FOR_MODERATORS",e[e.BLACKLIST_ON_MY_VIDEO=4]="BLACKLIST_ON_MY_VIDEO",e[e.UNBLACKLIST_ON_MY_VIDEO=5]="UNBLACKLIST_ON_MY_VIDEO",e[e.MY_VIDEO_PUBLISHED=6]="MY_VIDEO_PUBLISHED",e[e.MY_VIDEO_IMPORT_SUCCESS=7]="MY_VIDEO_IMPORT_SUCCESS",e[e.MY_VIDEO_IMPORT_ERROR=8]="MY_VIDEO_IMPORT_ERROR",e[e.NEW_USER_REGISTRATION=9]="NEW_USER_REGISTRATION",e[e.NEW_FOLLOW=10]="NEW_FOLLOW",e[e.COMMENT_MENTION=11]="COMMENT_MENTION",e[e.VIDEO_AUTO_BLACKLIST_FOR_MODERATORS=12]="VIDEO_AUTO_BLACKLIST_FOR_MODERATORS",e[e.NEW_INSTANCE_FOLLOWER=13]="NEW_INSTANCE_FOLLOWER",e[e.AUTO_INSTANCE_FOLLOWING=14]="AUTO_INSTANCE_FOLLOWING"}(o||(o={})),function(e){e[e.NONE=0]="NONE",e[e.WEB=1]="WEB",e[e.EMAIL=2]="EMAIL"}(i||(i={})),function(e){e[e.ALL=0]="ALL",e[e.MANAGE_USERS=1]="MANAGE_USERS",e[e.MANAGE_SERVER_FOLLOW=2]="MANAGE_SERVER_FOLLOW",e[e.MANAGE_LOGS=3]="MANAGE_LOGS",e[e.MANAGE_DEBUG=4]="MANAGE_DEBUG",e[e.MANAGE_SERVER_REDUNDANCY=5]="MANAGE_SERVER_REDUNDANCY",e[e.MANAGE_VIDEO_ABUSES=6]="MANAGE_VIDEO_ABUSES",e[e.MANAGE_JOBS=7]="MANAGE_JOBS",e[e.MANAGE_CONFIGURATION=8]="MANAGE_CONFIGURATION",e[e.MANAGE_ACCOUNTS_BLOCKLIST=9]="MANAGE_ACCOUNTS_BLOCKLIST",e[e.MANAGE_SERVERS_BLOCKLIST=10]="MANAGE_SERVERS_BLOCKLIST",e[e.MANAGE_VIDEO_BLACKLIST=11]="MANAGE_VIDEO_BLACKLIST",e[e.REMOVE_ANY_VIDEO=12]="REMOVE_ANY_VIDEO",e[e.REMOVE_ANY_VIDEO_CHANNEL=13]="REMOVE_ANY_VIDEO_CHANNEL",e[e.REMOVE_ANY_VIDEO_PLAYLIST=14]="REMOVE_ANY_VIDEO_PLAYLIST",e[e.REMOVE_ANY_VIDEO_COMMENT=15]="REMOVE_ANY_VIDEO_COMMENT",e[e.UPDATE_ANY_VIDEO=16]="UPDATE_ANY_VIDEO",e[e.UPDATE_ANY_VIDEO_PLAYLIST=17]="UPDATE_ANY_VIDEO_PLAYLIST",e[e.SEE_ALL_VIDEOS=18]="SEE_ALL_VIDEOS",e[e.CHANGE_VIDEO_OWNERSHIP=19]="CHANGE_VIDEO_OWNERSHIP",e[e.MANAGE_PLUGINS=20]="MANAGE_PLUGINS",e[e.MANAGE_VIDEOS_REDUNDANCIES=21]="MANAGE_VIDEOS_REDUNDANCIES"}(r||(r={})),function(e){e[e.ADMINISTRATOR=0]="ADMINISTRATOR",e[e.MODERATOR=1]="MODERATOR",e[e.USER=2]="USER"}(a||(a={})),function(e){e[e.PENDING=1]="PENDING",e[e.REJECTED=2]="REJECTED",e[e.ACCEPTED=3]="ACCEPTED"}(s||(s={})),function(e){e[e.MANUAL=1]="MANUAL",e[e.AUTO_BEFORE_PUBLISHED=2]="AUTO_BEFORE_PUBLISHED"}(l||(l={})),function(e){e[e.PUBLIC=1]="PUBLIC",e[e.UNLISTED=2]="UNLISTED",e[e.PRIVATE=3]="PRIVATE"}(d||(d={})),function(e){e[e.REGULAR=1]="REGULAR",e[e.WATCH_LATER=2]="WATCH_LATER"}(c||(c={})),function(e){e[e.REGULAR=0]="REGULAR",e[e.DELETED=1]="DELETED",e[e.PRIVATE=2]="PRIVATE",e[e.UNAVAILABLE=3]="UNAVAILABLE"}(u||(u={})),function(e){e.WAITING="WAITING",e.ACCEPTED="ACCEPTED",e.REFUSED="REFUSED"}(h||(h={})),function(e){e[e.PUBLIC=1]="PUBLIC",e[e.UNLISTED=2]="UNLISTED",e[e.PRIVATE=3]="PRIVATE",e[e.INTERNAL=4]="INTERNAL"}(p||(p={})),function(e){e[e.H_NOVIDEO=0]="H_NOVIDEO",e[e.H_240P=240]="H_240P",e[e.H_360P=360]="H_360P",e[e.H_480P=480]="H_480P",e[e.H_720P=720]="H_720P",e[e.H_1080P=1080]="H_1080P",e[e.H_4K=2160]="H_4K"}(m||(m={})),function(e){e[e.PUBLISHED=1]="PUBLISHED",e[e.TO_TRANSCODE=2]="TO_TRANSCODE",e[e.TO_IMPORT=3]="TO_IMPORT"}(f||(f={})),function(e){e[e.PENDING=1]="PENDING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILED=3]="FAILED"}(E||(E={})),function(e){e.RSS="xml",e.ATOM="atom",e.JSON="json"}(g||(g={}));var b=n(30);n.d(t,"d",(function(){return b.d})),n.d(t,"e",(function(){return b.e})),n.d(t,"c",(function(){return b.c})),n.d(t,"a",(function(){return b.a})),n.d(t,"b",(function(){return b.b}))},177:function(e,t,n){"use strict";n.r(t),n(181);var o,i=n(16);!function(e){e[e.HLS=1]="HLS"}(o||(o={}));var r=n(15);class a{constructor(e){this.embed=e,this.isReady=!1,this.resolutions=[]}initialize(){this.constructChannel(),this.setupStateTracking(),this.notifyReady()}get element(){return this.embed.videoElement}constructChannel(){const e=r.build({window:window.parent,origin:"*",scope:this.embed.scope});e.bind("play",(e,t)=>this.embed.player.play()),e.bind("pause",(e,t)=>this.embed.player.pause()),e.bind("seek",(e,t)=>this.embed.player.currentTime(t)),e.bind("setVolume",(e,t)=>this.embed.player.volume(t)),e.bind("getVolume",(e,t)=>this.embed.player.volume()),e.bind("isReady",(e,t)=>this.isReady),e.bind("setResolution",(e,t)=>this.setResolution(t)),e.bind("getResolutions",(e,t)=>this.resolutions),e.bind("setPlaybackRate",(e,t)=>this.embed.player.playbackRate(t)),e.bind("getPlaybackRate",(e,t)=>this.embed.player.playbackRate()),e.bind("getPlaybackRates",(e,t)=>this.embed.player.options_.playbackRates),this.channel=e}setResolution(e){if(console.log("set resolution %d",e),this.isWebtorrent()){if(-1===e&&!1===this.embed.player.webtorrent().isAutoResolutionPossible())return;return-1===e?void this.embed.player.webtorrent().enableAutoResolution():(this.embed.player.webtorrent().disableAutoResolution(),void this.embed.player.webtorrent().updateResolution(e))}this.embed.player.p2pMediaLoader().getHLSJS().nextLevel=e}notifyReady(){this.isReady=!0,this.channel.notify({method:"ready",params:!0})}setupStateTracking(){let e="unstarted";setInterval(()=>{this.channel.notify({method:"playbackStatusUpdate",params:{position:this.element.currentTime,volume:this.element.volume,playbackState:e}})},500),this.element.addEventListener("play",t=>{e="playing",this.channel.notify({method:"playbackStatusChange",params:"playing"})}),this.element.addEventListener("pause",t=>{e="paused",this.channel.notify({method:"playbackStatusChange",params:"paused"})}),this.isWebtorrent()?(this.embed.player.webtorrent().on("autoResolutionUpdate",()=>this.loadWebTorrentResolutions()),this.embed.player.webtorrent().on("videoFileUpdate",()=>this.loadWebTorrentResolutions())):this.embed.player.p2pMediaLoader().on("resolutionChange",()=>this.loadP2PMediaLoaderResolutions()),this.embed.player.on("volumechange",()=>{this.channel.notify({method:"volumeChange",params:this.embed.player.volume()})})}loadWebTorrentResolutions(){this.resolutions=[];const e=this.embed.player.webtorrent().getCurrentResolutionId();for(const t of this.embed.player.webtorrent().videoFiles){let n=t.resolution.label;t.fps&&t.fps>=50&&(n+=t.fps),this.resolutions.push({id:t.resolution.id,label:n,src:t.magnetUri,active:t.resolution.id===e,height:t.resolution.id})}this.channel.notify({method:"resolutionUpdate",params:this.resolutions})}loadP2PMediaLoaderResolutions(){this.resolutions=[];const e=this.embed.player.qualityLevels(),t=this.embed.player.qualityLevels().selectedIndex;for(let n=0;n<e.length;n++){const o=e[n];this.resolutions.push({id:o.id,label:o.height+"p",active:o.id===t,width:o.width,height:o.height})}this.channel.notify({method:"resolutionUpdate",params:this.resolutions})}isWebtorrent(){return this.embed.player.webtorrent}}var s=n(31);n.d(t,"PeerTubeEmbed",(function(){return d}));var l=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}l((o=o.apply(e,t||[])).next())}))};class d{constructor(e){this.videoContainerId=e,this.api=null,this.enableApi=!1,this.startTime=0,this.scope="peertube",this.videoElement=document.getElementById(e)}static main(){return l(this,void 0,void 0,(function*(){const e=new d("video-container");yield e.init()}))}getVideoUrl(e){return window.location.origin+"/api/v1/videos/"+e}loadVideoInfo(e){return fetch(this.getVideoUrl(e))}loadVideoCaptions(e){return fetch(this.getVideoUrl(e)+"/captions")}loadConfig(){return fetch("/api/v1/config")}removeElement(e){e.parentElement.removeChild(e)}displayError(e,t){this.videoElement&&this.removeElement(this.videoElement);const n=Object(i.e)(e,t),o=Object(i.e)("Sorry",t);document.title=o+" - "+n,document.getElementById("error-block").style.display="flex",document.getElementById("error-title").innerHTML=Object(i.e)("Sorry",t),document.getElementById("error-content").innerHTML=n}videoNotFound(e){this.displayError("This video does not exist.",e)}videoFetchError(e){this.displayError("We cannot fetch the video. Please try again later.",e)}getParamToggle(e,t,n){return e.has(t)?"1"===e.get(t)||"true"===e.get(t):n}getParamString(e,t,n){return e.has(t)?e.get(t):n}init(){return l(this,void 0,void 0,(function*(){try{yield this.initCore()}catch(e){console.error(e)}}))}initializeApi(){this.enableApi&&(this.api=new a(this),this.api.initialize())}loadParams(e){try{const t=new URL(window.location.toString()).searchParams;this.autoplay=this.getParamToggle(t,"autoplay",!1),this.controls=this.getParamToggle(t,"controls",!0),this.muted=this.getParamToggle(t,"muted",!1),this.loop=this.getParamToggle(t,"loop",!1),this.title=this.getParamToggle(t,"title",!0),this.enableApi=this.getParamToggle(t,"api",this.enableApi),this.warningTitle=this.getParamToggle(t,"warningTitle",!0),this.scope=this.getParamString(t,"scope",this.scope),this.subtitle=this.getParamString(t,"subtitle"),this.startTime=this.getParamString(t,"start"),this.stopTime=this.getParamString(t,"stop"),this.bigPlayBackgroundColor=this.getParamString(t,"bigPlayBackgroundColor"),this.foregroundColor=this.getParamString(t,"foregroundColor");const n=this.getParamString(t,"mode");this.mode=n?"p2p-media-loader"===n?"p2p-media-loader":"webtorrent":Array.isArray(e.streamingPlaylists)&&0!==e.streamingPlaylists.length?"p2p-media-loader":"webtorrent"}catch(e){console.error("Cannot get params from URL.",e)}}initCore(){return l(this,void 0,void 0,(function*(){const e=window.location.pathname.split("/"),t=e[e.length-1],i=this.loadVideoInfo(t),r=this.loadVideoCaptions(t),a=this.loadConfig(),l=s.a.getServerTranslations(window.location.origin,navigator.language),d=yield i;if(!d.ok){const e=yield l;return 404===d.status?this.videoNotFound(e):this.videoFetchError(e)}const c=yield d.json();this.loadPlaceholder(c);const u=[l,r,a,Promise.all([n.e(7),n.e(10)]).then(n.bind(null,179))],[h,p,m,f]=yield Promise.all(u),E=f.PeertubePlayerManager,g=yield this.buildCaptions(h,p);this.loadParams(c);const b={common:{autoplay:this.autoplay,controls:this.controls,muted:this.muted,loop:this.loop,captions:0!==g.length,startTime:this.startTime,stopTime:this.stopTime,subtitle:this.subtitle,videoCaptions:g,inactivityTimeout:1500,videoViewUrl:this.getVideoUrl(t)+"/views",playerElement:this.videoElement,onPlayerElementChange:e=>this.videoElement=e,videoDuration:c.duration,enableHotkeys:!0,peertubeLink:!0,poster:window.location.origin+c.previewPath,theaterButton:!1,serverUrl:window.location.origin,language:navigator.language,embedUrl:window.location.origin+c.embedPath},webtorrent:{videoFiles:c.files}};if("p2p-media-loader"===this.mode){const e=c.streamingPlaylists.find(e=>e.type===o.HLS);Object.assign(b,{p2pMediaLoader:{playlistUrl:e.playlistUrl,segmentsSha256Url:e.segmentsSha256Url,redundancyBaseUrls:e.redundancies.map(e=>e.baseUrl),trackerAnnounce:c.trackerUrls,videoFiles:e.files}})}this.player=yield E.initialize(this.mode,b,e=>this.player=e),this.player.on("customError",(e,t)=>this.handleError(t.err,h)),window.videojsPlayer=this.player,this.buildCSS(),yield this.buildDock(c,m),this.initializeApi(),this.removePlaceholder()}))}handleError(e,t){if(-1!==e.message.indexOf("from xs param"))return this.player.dispose(),this.videoElement=null,void this.displayError("This video is not available because the remote instance is not responding.",t)}buildDock(e,t){return l(this,void 0,void 0,(function*(){if(this.controls){if(!this.player.player_)return;const n=this.title?e.name:void 0,o=(yield t.json()).tracker.enabled&&this.warningTitle?'<span class="text">'+this.player.localize("Watching this video may reveal your IP address to others.")+"</span>":void 0;this.player.dock({title:n,description:o})}}))}buildCSS(){const e=document.getElementById("custom-css");this.bigPlayBackgroundColor&&e.style.setProperty("--embedBigPlayBackgroundColor",this.bigPlayBackgroundColor),this.foregroundColor&&e.style.setProperty("--embedForegroundColor",this.foregroundColor)}buildCaptions(e,t){return l(this,void 0,void 0,(function*(){if(t.ok){const{data:n}=yield t.json();return n.map(t=>({label:Object(i.e)(t.language.label,e),language:t.language.id,src:window.location.origin+t.captionPath}))}return[]}))}loadPlaceholder(e){const t=this.getPlaceholderElement(),n=window.location.origin+e.previewPath;t.style.backgroundImage=`url("${n}")`}removePlaceholder(){const e=this.getPlaceholderElement();e.parentElement.removeChild(e)}getPlaceholderElement(){return document.getElementById("placeholder-preview")}}d.main().catch(e=>console.error("Cannot init embed.",e))},181:function(e,t){},30:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d}));const o={en:"en-US",fr:"fr-FR",eu:"eu-ES",ca:"ca-ES",cs:"cs-CZ",de:"de-DE",es:"es-ES",pt:"pt-PT",fi:"fi-FI",sv:"sv-SE",pl:"pl-PL",ru:"ru-RU",nl:"nl-NL",zh:"zh-Hans-CN","zh-CN":"zh-Hans-CN","zh-TW":"zh-Hant-TW"},i=Object.keys({"en-US":"English","fr-FR":"Fran\xe7ais","ja-JP":"\u65e5\u672c\u8a9e","eu-ES":"Euskara","ca-ES":"Catal\xe0","cs-CZ":"\u010ce\u0161tina",eo:"Esperanto","el-GR":"\u03b5\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac","de-DE":"Deutsch","it-IT":"Italiano","nl-NL":"Nederlands","es-ES":"Espa\xf1ol",oc:"Occitan",gd:"G\xe0idhlig","zh-Hant-TW":"\u7e41\u9ad4\u4e2d\u6587\uff08\u53f0\u7063\uff09","pt-BR":"Portugu\xeas (Brasil)","pt-PT":"Portugu\xeas (Portugal)","sv-SE":"svenska","pl-PL":"Polski","fi-FI":"suomi","ru-RU":"\u0440\u0443\u0441\u0441\u043a\u0438\u0439","zh-Hans-CN":"\u7b80\u4f53\u4e2d\u6587\uff08\u4e2d\u56fd\uff09"}).concat(Object.keys(o));function r(e){return l(e)===l("en-US")}function a(e,t){return t&&t[e]?t[e]:e}function s(e){return-1!==i.indexOf(e)}function l(e){return e&&o[e]?o[e]:e}function d(e){return-1===e.indexOf("-")?e:e.split("-")[0]}i.map(e=>"/"+e)},31:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(16);class i{static getServerTranslations(e,t){const n=i.getLocalePath(e,t);return n?fetch(n+"/server.json").then(e=>e.json()).catch(e=>{console.error("Cannot get server translations",e)}):Promise.resolve(void 0)}static loadLocaleInVideoJS(e,t,n){const r=i.getLocalePath(e,t);if(!r)return Promise.resolve(void 0);let a;a=i.videojsLocaleCache[r]?Promise.resolve(i.videojsLocaleCache[r]):fetch(r+"/player.json").then(e=>e.json()).then(e=>(i.videojsLocaleCache[r]=e,e)).catch(e=>{console.error("Cannot get player translations",e)});const s=Object(o.a)(t);return a.then(e=>n.addLanguage(Object(o.b)(s),e))}static getLocalePath(e,t){const n=Object(o.a)(t);if(Object(o.c)(n)&&!Object(o.d)(n))return e+"/client/locales/"+n}}i.videojsLocaleCache={}}});