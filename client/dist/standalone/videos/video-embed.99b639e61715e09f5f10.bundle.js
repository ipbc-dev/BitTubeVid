!function(e){function t(t){for(var i,n,r=t[0],a=t[1],s=0,d=[];s<r.length;s++)n=r[s],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&d.push(o[n][0]),o[n]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i]);for(l&&l(t);d.length;)d.shift()()}var i={},o={6:0};function n(t){if(i[t])return i[t].exports;var o=i[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.e=function(e){var t=[],i=o[e];if(0!==i)if(i)t.push(i[2]);else{var r=new Promise((function(t,n){i=o[e]=[t,n]}));t.push(i[2]=r);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.src=function(e){return n.p+""+e+".chunk.js"}(e);var l=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(d);var i=o[e];if(0!==i){if(i){var n=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+n+": "+r+")",l.name="ChunkLoadError",l.type=n,l.request=r,i[1](l)}o[e]=void 0}};var d=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},n.m=e,n.c=i,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/client/standalone/videos/",n.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp=window.webpackJsonp||[],a=r.push.bind(r);r.push=t,r=r.slice();for(var s=0;s<r.length;s++)t(r[s]);var l=a;n(n.s=202)}({1:function(e,t,i){"use strict";function o(e,t,i,o){return new(i||(i=Promise))((function(n,r){function a(e){try{l(o.next(e))}catch(e){r(e)}}function s(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))}i.d(t,"a",(function(){return o}))},16:function(e,t,i){e.exports=function(){"use strict";return function(){var e=Math.floor(1000001*Math.random()),t={};function i(e){return Array.isArray?Array.isArray(e):-1!=e.constructor.toString().indexOf("Array")}var o={},n=function(e){try{var i=JSON.parse(e.data);if("object"!=typeof i||null===i)throw"malformed"}catch(e){return}var n,r,a,s=e.source,l=e.origin;if("string"==typeof i.method){var d=i.method.split("::");2==d.length?(n=d[0],a=d[1]):a=i.method}if(void 0!==i.id&&(r=i.id),"string"==typeof a){var c=!1;if(t[l]&&t[l][n])for(var u=0;u<t[l][n].length;u++)if(t[l][n][u].win===s){t[l][n][u].handler(l,a,i),c=!0;break}if(!c&&t["*"]&&t["*"][n])for(u=0;u<t["*"][n].length;u++)if(t["*"][n][u].win===s){t["*"][n][u].handler(l,a,i);break}}else void 0!==r&&o[r]&&o[r](l,a,i)};return window.addEventListener?window.addEventListener("message",n,!1):window.attachEvent&&window.attachEvent("onmessage",n),{build:function(n){var r=function(e){if(n.debugOutput&&window.console&&window.console.log){try{"string"!=typeof e&&(e=JSON.stringify(e))}catch(e){}window.console.log("["+l+"] "+e)}};if(!window.postMessage)throw"jschannel cannot run this browser, no postMessage";if(!window.JSON||!window.JSON.stringify||!window.JSON.parse)throw"jschannel cannot run this browser, no JSON parsing/serialization";if("object"!=typeof n)throw"Channel build invoked without a proper object argument";if(!n.window||!n.window.postMessage)throw"Channel.build() called without a valid window argument";window===n.window&&r("target window is same as present window -- use at your own risk");var a,s=!1;if("string"==typeof n.origin&&("*"===n.origin?s=!0:null!==(a=n.origin.match(/^https?:\/\/(?:[-a-zA-Z0-9_\.])+(?::\d+)?/))&&(n.origin=a[0].toLowerCase(),s=!0)),!s)throw"Channel.build() called with an invalid origin";if(void 0!==n.scope){if("string"!=typeof n.scope)throw"scope, when specified, must be a string";if(n.scope.split("::").length>1)throw"scope may not contain double colons: '::'"}else n.scope="__default";var l=function(){for(var e="",t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",i=0;i<5;i++)e+=t.charAt(Math.floor(Math.random()*t.length));return e}(),d={},c={},u={},h=!1,p=[],f=[],m=function(e,t,a){if("function"==typeof n.gotMessageObserver)try{n.gotMessageObserver(e,a)}catch(e){r("gotMessageObserver() raised an exception: "+e.toString())}if(a.id&&t){u[a.id]={};var s=function(e,t,i){var o=!1,n=!1;return{origin:t,invoke:function(t,o){if(!u[e])throw"attempting to invoke a callback of a nonexistent transaction: "+e;for(var n=!1,r=0;r<i.length;r++)if(t===i[r]){n=!0;break}if(!n)throw"request supports no such callback '"+t+"'";g({id:e,callback:t,params:o})},error:function(t,i){if(n=!0,!u[e])throw"error called for nonexistent message: "+e;delete u[e],g({id:e,error:t,message:i})},complete:function(t){if(n=!0,!u[e])throw"complete called for nonexistent message: "+e;delete u[e],g({id:e,result:t})},delayReturn:function(e){return"boolean"==typeof e&&(o=!0===e),o},completed:function(){return n}}}(a.id,e,a.callbacks?a.callbacks:[]);if(d[t])try{if(a.callbacks&&i(a.callbacks)&&a.callbacks.length>0)for(var l=0;l<a.callbacks.length;l++){for(var h=a.callbacks[l],p=a.params,f=h.split("/"),m=0;m<f.length-1;m++){var E=f[m];"object"!=typeof p[E]&&(p[E]={}),p=p[E]}p[f[f.length-1]]=function(){var e=h;return function(t){return s.invoke(e,t)}}()}var v=d[t](s,a.params);s.delayReturn()||s.completed()||s.complete(v)}catch(e){var b="runtime_error",y=null;if("string"==typeof e?y=e:"object"==typeof e&&(e instanceof Error?(b=e.constructor.name,y=e.message):e&&i(e)&&2==e.length?(b=e[0],y=e[1]):"string"==typeof e.error&&(b=e.error,e.message?"string"==typeof e.message?y=e.message:e=e.message:y="")),null===y)try{void 0===(y=JSON.stringify(e))&&(y=e.toString())}catch(t){y=e.toString()}s.error(b,y)}else s.error("method_not_found","No method '"+t+"' was (yet) bound by the provider")}else a.id&&a.callback?c[a.id]&&c[a.id].callbacks&&c[a.id].callbacks[a.callback]?c[a.id].callbacks[a.callback](a.params):r("ignoring invalid callback, id:"+a.id+" ("+a.callback+")"):a.id?c[a.id]?(a.error?c[a.id].error&&c[a.id].error(a.error,a.message):void 0!==a.result?c[a.id].success(a.result):c[a.id].success(),delete c[a.id],delete o[a.id]):r("ignoring invalid response: "+a.id):t&&d[t]&&d[t]({origin:e},a.params)};!function(e,i,o,n){function r(t){for(var i=0;i<t.length;i++)if(t[i].win===e)return!0;return!1}var a=!1;if("*"===i){for(var s in t)if(t.hasOwnProperty(s)&&"*"!==s&&"object"==typeof t[s][o]&&(a=r(t[s][o])))break}else t["*"]&&t["*"][o]&&(a=r(t["*"][o])),!a&&t[i]&&t[i][o]&&(a=r(t[i][o]));if(a)throw"A channel is already bound to the same window which overlaps with origin '"+i+"' and has scope '"+o+"'";"object"!=typeof t[i]&&(t[i]={}),"object"!=typeof t[i][o]&&(t[i][o]=[]),t[i][o].push({win:e,handler:n})}(n.window,n.origin,n.scope,m);var E=function(e){return[n.scope,e].join("::")},g=function(e,t){if(!e)throw"postMessage called with null message";if(t||h){if("function"==typeof n.postMessageObserver)try{n.postMessageObserver(n.origin,e)}catch(e){r("postMessageObserver() raised an exception: "+e.toString())}r("post message: "+JSON.stringify(e)+" with origin "+n.origin),n.window.postMessage(JSON.stringify(e),n.origin)}else r("queue message: "+JSON.stringify(e)),p.push(e)},v=function(e,t){var i;e=[].concat(e);for(var o=0;o<e.length;o++)t[i=e[o].toString()]=function(e){return function(t,i,o){i?b.call({method:e,params:t,success:i,error:o}):b.notify({method:e,params:t})}}(i)},b={remote:{},unbind:function(e,t){if(d[e]){if(!delete d[e])throw"can't delete method: "+e;return n.publish&&!t&&(h?b.notify({method:"__unbind",params:e}):f.push({action:"unbind",method:e})),!0}return!1},bind:function(e,t,i){if(!e||"string"!=typeof e)throw"'method' argument to bind must be string";if(!t||"function"!=typeof t)throw"callback missing from bind params";if(d[e])throw"method '"+e+"' is already bound!";return d[e]=t,n.publish&&!i&&(h?b.notify({method:"__bind",params:e}):f.push({action:"bind",method:e})),this},call:function(t){if(!t)throw"missing arguments to call function";if(!t.method||"string"!=typeof t.method)throw"'method' argument to call must be string";if(!t.success||"function"!=typeof t.success)throw"'success' callback missing from call";var i={},n=[],r=[],a=function(e,t){if(r.indexOf(t)>=0)throw"params cannot be a recursive data structure";if(t&&r.push(t),"object"==typeof t)for(var o in t)if(t.hasOwnProperty(o)){var s=e+(e.length?"/":"")+o;"function"==typeof t[o]?(i[s]=t[o],n.push(s),delete t[o]):"object"==typeof t[o]&&a(s,t[o])}};a("",t.params);var s,l,d,u={id:e,method:E(t.method),params:t.params};n.length&&(u.callbacks=n),t.timeout&&(s=e,l=t.timeout,d=E(t.method),window.setTimeout((function(){c[s]&&(c[s].error&&c[s].error("timeout_error","timeout ("+l+"ms) exceeded on method '"+d+"'"),delete c[s],delete o[s])}),l)),c[e]={callbacks:i,error:t.error,success:t.success},o[e]=m,e++,g(u)},notify:function(e){if(!e)throw"missing arguments to notify function";if(!e.method||"string"!=typeof e.method)throw"'method' argument to notify must be string";g({method:E(e.method),params:e.params})},destroy:function(){!function(e,i,o){for(var n=t[i][o],r=0;r<n.length;r++)n[r].win===e&&n.splice(r,1);0===t[i][o].length&&delete t[i][o]}(n.window,n.origin,n.scope),window.removeEventListener?window.removeEventListener("message",m,!1):window.detachEvent&&window.detachEvent("onmessage",m),h=!1,d={},u={},c={},n.origin=null,p=[],r("channel destroyed"),l=""}};return b.bind("__ready",(function(e,t){if(r("ready msg received"),h&&!n.reconnect)throw"received ready message while in ready state.";h=!0,l.length<6&&(l+="publish-request"===t.type?"-R":"-L"),r("ready msg accepted."),"publish-request"===t.type&&b.notify({method:"__ready",params:{type:"publish-reply",publish:f}});for(var i=0;i<t.publish.length;i++)"bind"===t.publish[i].action?v([t.publish[i].method],b.remote):delete b.remote[t.publish[i].method];for(n.reconnect||b.unbind("__ready",!0);p.length;)g(p.splice(0,1)[0]);f=[],"function"==typeof n.onReady&&n.onReady(b)}),!0),b.bind("__bind",(function(e,t){v([t],b.remote)}),!0),b.bind("__unbind",(function(e,t){b.remote[t]&&delete b.remote[t]}),!0),n.remote&&v(n.remote,b.remote),setTimeout((function(){l.length>0&&g({method:E("__ready"),params:{type:"publish-request",publish:f}},!0)}),0),b}}}()}()},17:function(e,t,i){"use strict";var o,n,r,a,s,l,d,c,u,h,p,f,m,E,g,v,b,y;i.d(t,"d",(function(){return A.d})),i.d(t,"e",(function(){return A.e})),i.d(t,"c",(function(){return A.c})),i.d(t,"a",(function(){return A.a})),i.d(t,"b",(function(){return A.b})),function(e){e[e.NONE=0]="NONE",e[e.BYPASS_VIDEO_AUTO_BLACKLIST=1]="BYPASS_VIDEO_AUTO_BLACKLIST"}(o||(o={})),function(e){e[e.NONE=0]="NONE",e[e.WEB=1]="WEB",e[e.EMAIL=2]="EMAIL"}(n||(n={})),function(e){e[e.NEW_VIDEO_FROM_SUBSCRIPTION=1]="NEW_VIDEO_FROM_SUBSCRIPTION",e[e.NEW_COMMENT_ON_MY_VIDEO=2]="NEW_COMMENT_ON_MY_VIDEO",e[e.NEW_VIDEO_ABUSE_FOR_MODERATORS=3]="NEW_VIDEO_ABUSE_FOR_MODERATORS",e[e.BLACKLIST_ON_MY_VIDEO=4]="BLACKLIST_ON_MY_VIDEO",e[e.UNBLACKLIST_ON_MY_VIDEO=5]="UNBLACKLIST_ON_MY_VIDEO",e[e.MY_VIDEO_PUBLISHED=6]="MY_VIDEO_PUBLISHED",e[e.MY_VIDEO_IMPORT_SUCCESS=7]="MY_VIDEO_IMPORT_SUCCESS",e[e.MY_VIDEO_IMPORT_ERROR=8]="MY_VIDEO_IMPORT_ERROR",e[e.NEW_USER_REGISTRATION=9]="NEW_USER_REGISTRATION",e[e.NEW_FOLLOW=10]="NEW_FOLLOW",e[e.COMMENT_MENTION=11]="COMMENT_MENTION",e[e.VIDEO_AUTO_BLACKLIST_FOR_MODERATORS=12]="VIDEO_AUTO_BLACKLIST_FOR_MODERATORS",e[e.NEW_INSTANCE_FOLLOWER=13]="NEW_INSTANCE_FOLLOWER",e[e.AUTO_INSTANCE_FOLLOWING=14]="AUTO_INSTANCE_FOLLOWING"}(r||(r={})),function(e){e[e.ALL=0]="ALL",e[e.MANAGE_USERS=1]="MANAGE_USERS",e[e.MANAGE_SERVER_FOLLOW=2]="MANAGE_SERVER_FOLLOW",e[e.MANAGE_LOGS=3]="MANAGE_LOGS",e[e.MANAGE_DEBUG=4]="MANAGE_DEBUG",e[e.MANAGE_SERVER_REDUNDANCY=5]="MANAGE_SERVER_REDUNDANCY",e[e.MANAGE_VIDEO_ABUSES=6]="MANAGE_VIDEO_ABUSES",e[e.MANAGE_JOBS=7]="MANAGE_JOBS",e[e.MANAGE_CONFIGURATION=8]="MANAGE_CONFIGURATION",e[e.MANAGE_ACCOUNTS_BLOCKLIST=9]="MANAGE_ACCOUNTS_BLOCKLIST",e[e.MANAGE_SERVERS_BLOCKLIST=10]="MANAGE_SERVERS_BLOCKLIST",e[e.MANAGE_VIDEO_BLACKLIST=11]="MANAGE_VIDEO_BLACKLIST",e[e.REMOVE_ANY_VIDEO=12]="REMOVE_ANY_VIDEO",e[e.REMOVE_ANY_VIDEO_CHANNEL=13]="REMOVE_ANY_VIDEO_CHANNEL",e[e.REMOVE_ANY_VIDEO_PLAYLIST=14]="REMOVE_ANY_VIDEO_PLAYLIST",e[e.REMOVE_ANY_VIDEO_COMMENT=15]="REMOVE_ANY_VIDEO_COMMENT",e[e.UPDATE_ANY_VIDEO=16]="UPDATE_ANY_VIDEO",e[e.UPDATE_ANY_VIDEO_PLAYLIST=17]="UPDATE_ANY_VIDEO_PLAYLIST",e[e.SEE_ALL_VIDEOS=18]="SEE_ALL_VIDEOS",e[e.CHANGE_VIDEO_OWNERSHIP=19]="CHANGE_VIDEO_OWNERSHIP",e[e.MANAGE_PLUGINS=20]="MANAGE_PLUGINS",e[e.MANAGE_VIDEOS_REDUNDANCIES=21]="MANAGE_VIDEOS_REDUNDANCIES"}(a||(a={})),function(e){e[e.ADMINISTRATOR=0]="ADMINISTRATOR",e[e.MODERATOR=1]="MODERATOR",e[e.USER=2]="USER"}(s||(s={})),function(e){e[e.VIOLENT_OR_REPULSIVE=1]="VIOLENT_OR_REPULSIVE",e[e.HATEFUL_OR_ABUSIVE=2]="HATEFUL_OR_ABUSIVE",e[e.SPAM_OR_MISLEADING=3]="SPAM_OR_MISLEADING",e[e.PRIVACY=4]="PRIVACY",e[e.RIGHTS=5]="RIGHTS",e[e.SERVER_RULES=6]="SERVER_RULES",e[e.THUMBNAILS=7]="THUMBNAILS",e[e.CAPTIONS=8]="CAPTIONS"}(l||(l={})),function(e){e[e.PENDING=1]="PENDING",e[e.REJECTED=2]="REJECTED",e[e.ACCEPTED=3]="ACCEPTED"}(d||(d={})),function(e){e[e.MANUAL=1]="MANUAL",e[e.AUTO_BEFORE_PUBLISHED=2]="AUTO_BEFORE_PUBLISHED"}(c||(c={})),function(e){e[e.PENDING=1]="PENDING",e[e.SUCCESS=2]="SUCCESS",e[e.FAILED=3]="FAILED",e[e.REJECTED=4]="REJECTED"}(u||(u={})),function(e){e[e.REGULAR=0]="REGULAR",e[e.DELETED=1]="DELETED",e[e.PRIVATE=2]="PRIVATE",e[e.UNAVAILABLE=3]="UNAVAILABLE"}(h||(h={})),function(e){e[e.PUBLIC=1]="PUBLIC",e[e.UNLISTED=2]="UNLISTED",e[e.PRIVATE=3]="PRIVATE"}(p||(p={})),function(e){e[e.REGULAR=1]="REGULAR",e[e.WATCH_LATER=2]="WATCH_LATER"}(f||(f={})),function(e){e[e.MINIATURE=1]="MINIATURE",e[e.PREVIEW=2]="PREVIEW"}(m||(m={})),function(e){e.WAITING="WAITING",e.ACCEPTED="ACCEPTED",e.REFUSED="REFUSED"}(E||(E={})),function(e){e[e.PUBLIC=1]="PUBLIC",e[e.UNLISTED=2]="UNLISTED",e[e.PRIVATE=3]="PRIVATE",e[e.INTERNAL=4]="INTERNAL"}(g||(g={})),function(e){e[e.H_NOVIDEO=0]="H_NOVIDEO",e[e.H_240P=240]="H_240P",e[e.H_360P=360]="H_360P",e[e.H_480P=480]="H_480P",e[e.H_720P=720]="H_720P",e[e.H_1080P=1080]="H_1080P",e[e.H_4K=2160]="H_4K"}(v||(v={})),function(e){e[e.PUBLISHED=1]="PUBLISHED",e[e.TO_TRANSCODE=2]="TO_TRANSCODE",e[e.TO_IMPORT=3]="TO_IMPORT"}(b||(b={})),i(30),function(e){e.RSS="xml",e.ATOM="atom",e.JSON="json"}(y||(y={}));var _,O,A=i(29);Object.assign({},{"filter:api.trending-videos.videos.list.params":!0,"filter:api.trending-videos.videos.list.result":!0,"filter:api.most-liked-videos.videos.list.params":!0,"filter:api.most-liked-videos.videos.list.result":!0,"filter:api.local-videos.videos.list.params":!0,"filter:api.local-videos.videos.list.result":!0,"filter:api.recently-added-videos.videos.list.params":!0,"filter:api.recently-added-videos.videos.list.result":!0,"filter:api.user-subscriptions-videos.videos.list.params":!0,"filter:api.user-subscriptions-videos.videos.list.result":!0,"filter:api.video-watch.video.get.params":!0,"filter:api.video-watch.video.get.result":!0,"filter:api.video-watch.video-threads.list.params":!0,"filter:api.video-watch.video-threads.list.result":!0,"filter:api.video-watch.video-thread-replies.list.params":!0,"filter:api.video-watch.video-thread-replies.list.result":!0,"filter:api.search.videos.list.params":!0,"filter:api.search.videos.list.result":!0,"filter:api.search.video-channels.list.params":!0,"filter:api.search.video-channels.list.result":!0,"filter:api.signup.registration.create.params":!0,"filter:internal.video-watch.player.build-options.params":!0,"filter:internal.video-watch.player.build-options.result":!0,"filter:internal.common.svg-icons.get-content.params":!0,"filter:internal.common.svg-icons.get-content.result":!0},{"action:application.init":!0,"action:video-watch.init":!0,"action:video-watch.video.loaded":!0,"action:video-watch.player.loaded":!0,"action:video-watch.video-threads.loaded":!0,"action:video-watch.video-thread-replies.loaded":!0,"action:login.init":!0,"action:search.init":!0,"action:router.navigation-end":!0,"action:signup.register.init":!0}),function(e){e[e.STATIC=1]="STATIC",e[e.ACTION=2]="ACTION",e[e.FILTER=3]="FILTER"}(_||(_={})),function(e){e[e.PLUGIN=1]="PLUGIN",e[e.THEME=2]="THEME"}(O||(O={})),Object.assign({},{"filter:api.videos.list.params":!0,"filter:api.videos.list.result":!0,"filter:api.video.get.result":!0,"filter:api.video.upload.accept.result":!0,"filter:api.video.pre-import-url.accept.result":!0,"filter:api.video.pre-import-torrent.accept.result":!0,"filter:api.video.post-import-url.accept.result":!0,"filter:api.video.post-import-torrent.accept.result":!0,"filter:api.video-thread.create.accept.result":!0,"filter:api.video-comment-reply.create.accept.result":!0,"filter:api.video-threads.list.params":!0,"filter:api.video-threads.list.result":!0,"filter:api.video-thread-comments.list.params":!0,"filter:api.video-thread-comments.list.result":!0,"filter:video.auto-blacklist.result":!0,"filter:api.user.signup.allowed.result":!0},{"action:application.listening":!0,"action:api.video.updated":!0,"action:api.video.deleted":!0,"action:api.video.uploaded":!0,"action:api.video.viewed":!0,"action:api.video-thread.created":!0,"action:api.video-comment-reply.created":!0,"action:api.video-comment.deleted":!0,"action:api.user.blocked":!0,"action:api.user.unblocked":!0,"action:api.user.registered":!0,"action:api.user.created":!0,"action:api.user.deleted":!0,"action:api.user.updated":!0,"action:api.user.oauth2-got-token":!0})},202:function(e,t,i){"use strict";i.r(t),i.d(t,"PeerTubeEmbed",(function(){return d}));var o=i(1),n=(i(206),i(17)),r=i(30),a=i(16);class s{constructor(e){this.embed=e,this.isReady=!1,this.resolutions=[]}initialize(){this.constructChannel(),this.setupStateTracking(),this.notifyReady()}get element(){return this.embed.videoElement}constructChannel(){const e=a.build({window:window.parent,origin:"*",scope:this.embed.scope});e.bind("play",(e,t)=>this.embed.player.play()),e.bind("pause",(e,t)=>this.embed.player.pause()),e.bind("seek",(e,t)=>this.embed.player.currentTime(t)),e.bind("setVolume",(e,t)=>this.embed.player.volume(t)),e.bind("getVolume",(e,t)=>this.embed.player.volume()),e.bind("isReady",(e,t)=>this.isReady),e.bind("setResolution",(e,t)=>this.setResolution(t)),e.bind("getResolutions",(e,t)=>this.resolutions),e.bind("getCaptions",(e,t)=>this.getCaptions()),e.bind("setCaption",(e,t)=>this.setCaption(t)),e.bind("setPlaybackRate",(e,t)=>this.embed.player.playbackRate(t)),e.bind("getPlaybackRate",(e,t)=>this.embed.player.playbackRate()),e.bind("getPlaybackRates",(e,t)=>this.embed.player.options_.playbackRates),this.channel=e}setResolution(e){if(console.log("set resolution %d",e),this.isWebtorrent()){if(-1===e&&!1===this.embed.player.webtorrent().isAutoResolutionPossible())return;return-1===e?void this.embed.player.webtorrent().enableAutoResolution():(this.embed.player.webtorrent().disableAutoResolution(),void this.embed.player.webtorrent().updateResolution(e))}this.embed.player.p2pMediaLoader().getHLSJS().nextLevel=e}getCaptions(){return this.embed.player.textTracks().tracks_.map(e=>({id:e.id,src:e.src,label:e.label,mode:e.mode}))}setCaption(e){const t=this.embed.player.textTracks().tracks_;for(const i of t)i.mode=i.id===e?"showing":"disabled"}notifyReady(){this.isReady=!0,this.channel.notify({method:"ready",params:!0})}setupStateTracking(){let e="unstarted";setInterval(()=>{this.channel.notify({method:"playbackStatusUpdate",params:{position:this.element.currentTime,volume:this.element.volume,duration:this.embed.player.duration(),playbackState:e}})},500),this.element.addEventListener("play",t=>{e="playing",this.channel.notify({method:"playbackStatusChange",params:"playing"})}),this.element.addEventListener("pause",t=>{e="paused",this.channel.notify({method:"playbackStatusChange",params:"paused"})}),this.element.addEventListener("ended",t=>{e="ended",this.channel.notify({method:"playbackStatusChange",params:"ended"})}),this.isWebtorrent()?(this.embed.player.webtorrent().on("autoResolutionUpdate",()=>this.loadWebTorrentResolutions()),this.embed.player.webtorrent().on("videoFileUpdate",()=>this.loadWebTorrentResolutions())):this.embed.player.p2pMediaLoader().on("resolutionChange",()=>this.loadP2PMediaLoaderResolutions()),this.embed.player.on("volumechange",()=>{this.channel.notify({method:"volumeChange",params:this.embed.player.volume()})})}loadWebTorrentResolutions(){this.resolutions=[];const e=this.embed.player.webtorrent().getCurrentResolutionId();for(const t of this.embed.player.webtorrent().videoFiles){let i=t.resolution.label;t.fps&&t.fps>=50&&(i+=t.fps),this.resolutions.push({id:t.resolution.id,label:i,src:t.magnetUri,active:t.resolution.id===e,height:t.resolution.id})}this.channel.notify({method:"resolutionUpdate",params:this.resolutions})}loadP2PMediaLoaderResolutions(){this.resolutions=[];const e=this.embed.player.qualityLevels(),t=this.embed.player.qualityLevels().selectedIndex;for(let i=0;i<e.length;i++){const o=e[i];this.resolutions.push({id:o.id,label:o.height+"p",active:o.id===t,width:o.width,height:o.height})}this.channel.notify({method:"resolutionUpdate",params:this.resolutions})}isWebtorrent(){return this.embed.player.webtorrent}}var l=i(31);class d{constructor(e){this.videoContainerId=e,this.api=null,this.enableApi=!1,this.startTime=0,this.scope="peertube",this.videoElement=document.getElementById(e)}static main(){return Object(o.a)(this,void 0,void 0,(function*(){const e=new d("video-container");yield e.init()}))}getVideoUrl(e){return window.location.origin+"/api/v1/videos/"+e}loadVideoInfo(e){return fetch(this.getVideoUrl(e))}loadVideoCaptions(e){return fetch(this.getVideoUrl(e)+"/captions")}loadConfig(){return fetch("/api/v1/config")}removeElement(e){e.parentElement.removeChild(e)}displayError(e,t){this.videoElement&&this.removeElement(this.videoElement);const i=Object(n.e)(e,t),o=Object(n.e)("Sorry",t);document.title=o+" - "+i,document.getElementById("error-block").style.display="flex",document.getElementById("error-title").innerHTML=Object(n.e)("Sorry",t),document.getElementById("error-content").innerHTML=i}videoNotFound(e){this.displayError("This video does not exist.",e)}videoFetchError(e){this.displayError("We cannot fetch the video. Please try again later.",e)}getParamToggle(e,t,i){return e.has(t)?"1"===e.get(t)||"true"===e.get(t):i}getParamString(e,t,i){return e.has(t)?e.get(t):i}init(){return Object(o.a)(this,void 0,void 0,(function*(){try{yield this.initCore()}catch(e){console.error(e)}}))}initializeApi(){this.enableApi&&(this.api=new s(this),this.api.initialize())}loadParams(e){try{const t=new URL(window.location.toString()).searchParams;this.autoplay=this.getParamToggle(t,"autoplay",!1),this.controls=this.getParamToggle(t,"controls",!0),this.muted=this.getParamToggle(t,"muted",void 0),this.loop=this.getParamToggle(t,"loop",!1),this.title=this.getParamToggle(t,"title",!0),this.enableApi=this.getParamToggle(t,"api",this.enableApi),this.warningTitle=this.getParamToggle(t,"warningTitle",!0),this.scope=this.getParamString(t,"scope",this.scope),this.subtitle=this.getParamString(t,"subtitle"),this.startTime=this.getParamString(t,"start"),this.stopTime=this.getParamString(t,"stop"),this.bigPlayBackgroundColor=this.getParamString(t,"bigPlayBackgroundColor"),this.foregroundColor=this.getParamString(t,"foregroundColor");const i=this.getParamString(t,"mode");this.mode=i?"p2p-media-loader"===i?"p2p-media-loader":"webtorrent":Array.isArray(e.streamingPlaylists)&&0!==e.streamingPlaylists.length?"p2p-media-loader":"webtorrent"}catch(e){console.error("Cannot get params from URL.",e)}}initCore(){return Object(o.a)(this,void 0,void 0,(function*(){const e=window.location.pathname.split("/"),t=e[e.length-1],o=this.loadVideoInfo(t),n=this.loadVideoCaptions(t),a=this.loadConfig(),s=l.a.getServerTranslations(window.location.origin,navigator.language),d=yield o;if(!d.ok){const e=yield s;return 404===d.status?this.videoNotFound(e):this.videoFetchError(e)}const c=yield d.json();this.loadPlaceholder(c);const u=[s,n,a,Promise.all([i.e(7),i.e(10)]).then(i.bind(null,203))],[h,p,f,m]=yield Promise.all(u),E=m.PeertubePlayerManager,g=yield this.buildCaptions(h,p);this.loadParams(c);const v={common:{autoplay:this.autoplay,controls:this.controls,muted:this.muted,loop:this.loop,captions:0!==g.length,startTime:this.startTime,stopTime:this.stopTime,subtitle:this.subtitle,videoCaptions:g,inactivityTimeout:2500,videoViewUrl:this.getVideoUrl(t)+"/views",playerElement:this.videoElement,onPlayerElementChange:e=>this.videoElement=e,videoDuration:c.duration,enableHotkeys:!0,peertubeLink:!0,poster:window.location.origin+c.previewPath,theaterButton:!1,serverUrl:window.location.origin,language:navigator.language,embedUrl:window.location.origin+c.embedPath},webtorrent:{videoFiles:c.files}};if("p2p-media-loader"===this.mode){const e=c.streamingPlaylists.find(e=>e.type===r.a.HLS);Object.assign(v,{p2pMediaLoader:{playlistUrl:e.playlistUrl,segmentsSha256Url:e.segmentsSha256Url,redundancyBaseUrls:e.redundancies.map(e=>e.baseUrl),trackerAnnounce:c.trackerUrls,videoFiles:e.files}})}this.player=yield E.initialize(this.mode,v,e=>this.player=e),this.player.on("customError",(e,t)=>this.handleError(t.err,h)),window.videojsPlayer=this.player,this.buildCSS(),yield this.buildDock(c,f),this.initializeApi(),this.removePlaceholder()}))}handleError(e,t){if(-1!==e.message.indexOf("from xs param"))return this.player.dispose(),this.videoElement=null,void this.displayError("This video is not available because the remote instance is not responding.",t)}buildDock(e,t){return Object(o.a)(this,void 0,void 0,(function*(){if(!this.controls)return;if(!this.player.player_)return;const i=this.title?e.name:void 0,o=(yield t.json()).tracker.enabled&&this.warningTitle?'<span class="text">'+Object(n.e)("Watching this video may reveal your IP address to others.")+"</span>":void 0;this.player.dock({title:i,description:o})}))}buildCSS(){const e=document.getElementById("custom-css");this.bigPlayBackgroundColor&&e.style.setProperty("--embedBigPlayBackgroundColor",this.bigPlayBackgroundColor),this.foregroundColor&&e.style.setProperty("--embedForegroundColor",this.foregroundColor)}buildCaptions(e,t){return Object(o.a)(this,void 0,void 0,(function*(){if(t.ok){const{data:i}=yield t.json();return i.map(t=>({label:Object(n.e)(t.language.label,e),language:t.language.id,src:window.location.origin+t.captionPath}))}return[]}))}loadPlaceholder(e){const t=this.getPlaceholderElement(),i=window.location.origin+e.previewPath;t.style.backgroundImage=`url("${i}")`}removePlaceholder(){const e=this.getPlaceholderElement();e.parentElement.removeChild(e)}getPlaceholderElement(){return document.getElementById("placeholder-preview")}}d.main().catch(e=>console.error("Cannot init embed.",e))},206:function(e,t){},29:function(e,t,i){"use strict";i.d(t,"d",(function(){return r})),i.d(t,"e",(function(){return a})),i.d(t,"c",(function(){return s})),i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return d}));const o={"ar-001":"ar",ca:"ca-ES",cs:"cs-CZ",de:"de-DE",el:"el-GR",en:"en-US",es:"es-ES",eu:"eu-ES",fi:"fi-FI",fr:"fr-FR",hu:"hu-HU",it:"it-IT",ja:"ja-JP",nl:"nl-NL",pl:"pl-PL",pt:"pt-BR",ru:"ru-RU",sv:"sv-SE",th:"th-TH",vi:"vi-VN","zh-CN":"zh-Hans-CN","zh-Hans":"zh-Hans-CN","zh-Hant":"zh-Hant-TW","zh-TW":"zh-Hant-TW",zh:"zh-Hans-CN"},n=Object.keys({"en-US":"English",ar:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629","ca-ES":"Catal\xe0","cs-CZ":"\u010ce\u0161tina","de-DE":"Deutsch","el-GR":"\u03b5\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",eo:"Esperanto","es-ES":"Espa\xf1ol","eu-ES":"Euskara","fi-FI":"suomi","fr-FR":"Fran\xe7ais",gd:"G\xe0idhlig","hu-HU":"magyar","it-IT":"Italiano","ja-JP":"\u65e5\u672c\u8a9e",kab:"Taqbaylit","nl-NL":"Nederlands",oc:"Occitan","pl-PL":"Polski","pt-BR":"Portugu\xeas (Brasil)","pt-PT":"Portugu\xeas (Portugal)","ru-RU":"\u0440\u0443\u0441\u0441\u043a\u0438\u0439","sv-SE":"svenska","th-TH":"\u0e44\u0e17\u0e22","vi-VN":"Ti\u1ebfng Vi\u1ec7t","zh-Hans-CN":"\u7b80\u4f53\u4e2d\u6587\uff08\u4e2d\u56fd\uff09","zh-Hant-TW":"\u7e41\u9ad4\u4e2d\u6587\uff08\u53f0\u7063\uff09"}).concat(Object.keys(o));function r(e){return l(e)===l("en-US")}function a(e,t){return t&&t[e]?t[e]:e}function s(e){return n.includes(e)}function l(e){return e&&o[e]?o[e]:e}function d(e){return!1===e.includes("-")?e:e.split("-")[0]}n.map(e=>"/"+e)},30:function(e,t,i){"use strict";var o;i.d(t,"a",(function(){return o})),function(e){e[e.HLS=1]="HLS"}(o||(o={}))},31:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var o=i(17);class n{static getServerTranslations(e,t){const i=n.getLocalePath(e,t);return i?fetch(i+"/server.json").then(e=>e.json()).catch(e=>{console.error("Cannot get server translations",e)}):Promise.resolve(void 0)}static loadLocaleInVideoJS(e,t,i){const r=n.getLocalePath(e,t);if(!r)return Promise.resolve(void 0);let a;a=n.videojsLocaleCache[r]?Promise.resolve(n.videojsLocaleCache[r]):fetch(r+"/player.json").then(e=>e.json()).then(e=>(n.videojsLocaleCache[r]=e,e)).catch(e=>{console.error("Cannot get player translations",e)});const s=Object(o.a)(t);return a.then(e=>i.addLanguage(Object(o.b)(s),e))}static getLocalePath(e,t){const i=Object(o.a)(t);if(Object(o.c)(i)&&!Object(o.d)(i))return e+"/client/locales/"+i}}n.videojsLocaleCache={}}});