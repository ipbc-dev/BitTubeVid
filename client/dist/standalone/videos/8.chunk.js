(window.webpackJsonp=window.webpackJsonp||[]).push([[8,9],{178:function(t,s,e){"use strict";e.r(s),e.d(s,"P2pMediaLoaderPlugin",(function(){return l}));var n=e(0),i=e(40),o=e(13),a=e(2);window.videojs=n,e(175);const r=n.getPlugin("plugin");class l extends r{constructor(t,s){if(super(t,s),this.CONSTANTS={INFO_SCHEDULER:1e3},this.statsP2PBytes={pendingDownload:[],pendingUpload:[],numPeers:0,totalDownload:0,totalUpload:0},this.statsHTTPBytes={pendingDownload:[],pendingUpload:[],totalDownload:0,totalUpload:0},this.options=s,!n.Html5Hlsjs){const s="HLS.js does not seem to be supported.";return console.warn(s),void t.ready(()=>t.trigger("error",new Error(s)))}n.Html5Hlsjs.addHook("beforeinitialize",(t,s)=>{this.hlsjs=s}),Object(i.initVideoJsContribHlsJsPlayer)(t),this.startTime=Object(a.g)(s.startTime),t.src({type:s.type,src:s.src}),t.one("play",()=>{t.addClass("vjs-has-big-play-button-clicked")}),t.ready(()=>this.initialize())}dispose(){this.hlsjs&&this.hlsjs.destroy(),this.p2pEngine&&this.p2pEngine.destroy(),clearInterval(this.networkInfoInterval)}getHLSJS(){return this.hlsjs}initialize(){Object(i.initHlsJsPlayer)(this.hlsjs),this.p2pEngine=this.player.tech_.options_.hlsjsConfig.loader.getEngine(),this.hlsjs.on("hlsLevelSwitching",(t,s)=>{this.trigger("resolutionChange",{auto:this.hlsjs.autoLevelEnabled,resolutionId:s.height})}),this.p2pEngine.on(o.Events.SegmentError,(t,s)=>{console.error("Segment error.",t,s),this.options.redundancyUrlManager.removeBySegmentUrl(t.requestUrl)}),this.statsP2PBytes.numPeers=1+this.options.redundancyUrlManager.countBaseUrls(),this.runStats(),this.player.one("canplay",()=>{this.startTime&&this.player.currentTime(this.startTime)})}runStats(){this.p2pEngine.on(o.Events.PieceBytesDownloaded,(t,s)=>{const e="p2p"===t?this.statsP2PBytes:this.statsHTTPBytes;e.pendingDownload.push(s),e.totalDownload+=s}),this.p2pEngine.on(o.Events.PieceBytesUploaded,(t,s)=>{const e="p2p"===t?this.statsP2PBytes:this.statsHTTPBytes;e.pendingUpload.push(s),e.totalUpload+=s}),this.p2pEngine.on(o.Events.PeerConnect,()=>this.statsP2PBytes.numPeers++),this.p2pEngine.on(o.Events.PeerClose,()=>this.statsP2PBytes.numPeers--),this.networkInfoInterval=setInterval(()=>{const t=this.arraySum(this.statsP2PBytes.pendingDownload),s=this.arraySum(this.statsP2PBytes.pendingUpload),e=this.arraySum(this.statsHTTPBytes.pendingDownload),n=this.arraySum(this.statsHTTPBytes.pendingUpload);return this.statsP2PBytes.pendingDownload=[],this.statsP2PBytes.pendingUpload=[],this.statsHTTPBytes.pendingDownload=[],this.statsHTTPBytes.pendingUpload=[],this.player.trigger("p2pInfo",{http:{downloadSpeed:e,uploadSpeed:n,downloaded:this.statsHTTPBytes.totalDownload,uploaded:this.statsHTTPBytes.totalUpload},p2p:{downloadSpeed:t,uploadSpeed:s,numPeers:this.statsP2PBytes.numPeers,downloaded:this.statsP2PBytes.totalDownload,uploaded:this.statsP2PBytes.totalUpload}})},this.CONSTANTS.INFO_SCHEDULER)}arraySum(t){return t.reduce((t,s)=>t+s,0)}}n.registerPlugin("p2pMediaLoader",l)},75:function(t,s){},76:function(t,s){},77:function(t,s){},78:function(t,s){},79:function(t,s){},80:function(t,s){}}]);