(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"25cm":function(e,t,r){"use strict";var n=r("tPH9"),o=r("/1FC");t.a=function(e,t,r){var i=t(e);return Object(o.a)(e)?i:Object(n.a)(i,r(e))}},"2L7+":function(e,t,r){"use strict";r.d(t,"a",function(){return f});var n=r("mrSG"),o=r("fXoL"),i=r("ey9i"),a=(r("xMQD"),r("GxWh")),c=r("QLwe"),s=r("Imgh"),l=r("ofXK"),u=r("EcKj");const d=["userBanModal"],b=function(e,t){return{user:e,account:t}};function h(e,t){if(1&e){const e=o.Xb();o.Ub(0),o.Wb(1,"my-user-ban-modal",1,2),o.kc("userBanned",function(){return o.Kc(e),o.oc().onUserBanned()}),o.Vb(),o.Rb(3,"my-action-dropdown",3),o.Tb()}if(2&e){const e=o.oc();o.Db(3),o.vc("actions",e.userActions)("entry",o.Ac(6,b,e.user,e.account))("buttonSize",e.buttonSize)("placement",e.placement)("label",e.label)("container",e.container)}}let f=(()=>{class e{constructor(e,t,r,n,i,a,c){this.authService=e,this.notifier=t,this.confirmService=r,this.serverService=n,this.userService=i,this.blocklistService=a,this.bulkService=c,this.buttonSize="normal",this.placement="right-top right-bottom auto",this.container=void 0,this.userChanged=new o.n,this.userDeleted=new o.n,this.userActions=[]}get requiresEmailVerification(){return this.serverConfig.signup.requiresEmailVerification}ngOnInit(){this.serverConfig=this.serverService.getTmpConfig(),this.serverService.getConfig().subscribe(e=>this.serverConfig=e)}ngOnChanges(){this.buildActions()}openBanUserModal(e){"root"!==e.username?this.userBanModal.openModal(e):this.notifier.error("\u60A8\u4E0D\u80FD\u963B\u64CB root\u3002")}onUserBanned(){this.userChanged.emit()}unbanUser(e){return Object(n.a)(this,void 0,void 0,function*(){!1!==(yield this.confirmService.confirm("\u60A8\u771F\u7684\u60F3\u8981\u53D6\u6D88\u963B\u64CB " + e.username + " \u55CE\uFF1F","\u53D6\u6D88\u963B\u64CB"))&&this.userService.unbanUsers(e).subscribe(()=>{this.notifier.success("\u4F7F\u7528\u8005 " + e.username + " \u5DF2\u53D6\u6D88\u963B\u64CB\u3002"),this.userChanged.emit()},e=>this.notifier.error(e.message))})}removeUser(e){return Object(n.a)(this,void 0,void 0,function*(){if("root"===e.username)return void this.notifier.error("\u60A8\u7121\u6CD5\u522A\u9664 root\u3002");const t="\u5982\u679C\u60A8\u79FB\u9664\u6B64\u4F7F\u7528\u8005\uFF0C\u60A8\u5C31\u6C92\u8FA6\u6CD5\u518D\u4F7F\u7528\u540C\u4E00\u500B\u4F7F\u7528\u8005\u540D\u7A31\u4F86\u5EFA\u7ACB\u53E6\u4E00\u500B\u4F7F\u7528\u8005\uFF01";!1!==(yield this.confirmService.confirm(t,"\u522A\u9664"))&&this.userService.removeUser(e).subscribe(()=>{this.notifier.success("\u4F7F\u7528\u8005 " + e.username + " \u5DF2\u522A\u9664\u3002"),this.userDeleted.emit()},e=>this.notifier.error(e.message))})}setEmailAsVerified(e){this.userService.updateUser(e.id,{emailVerified:!0}).subscribe(()=>{this.notifier.success("\u4F7F\u7528\u8005 " + e.username + " \u7684\u96FB\u5B50\u90F5\u4EF6\u8A2D\u5B9A\u70BA\u5DF2\u9A57\u8B49"),this.userChanged.emit()},e=>this.notifier.error(e.message))}blockAccountByUser(e){this.blocklistService.blockAccountByUser(e).subscribe(()=>{this.notifier.success("\u5E33\u865F " + e.nameWithHost + " \u5DF2\u89E3\u9664\u975C\u97F3\u3002"),this.account.mutedByUser=!0,this.userChanged.emit()},e=>this.notifier.error(e.message))}unblockAccountByUser(e){this.blocklistService.unblockAccountByUser(e).subscribe(()=>{this.notifier.success("\u5E33\u865F " + e.nameWithHost + " \u5DF2\u89E3\u9664\u975C\u97F3\u3002"),this.account.mutedByUser=!1,this.userChanged.emit()},e=>this.notifier.error(e.message))}blockServerByUser(e){this.blocklistService.blockServerByUser(e).subscribe(()=>{this.notifier.success("\u7AD9\u81FA " + e + " \u5DF2\u975C\u97F3\u3002"),this.account.mutedServerByUser=!0,this.userChanged.emit()},e=>this.notifier.error(e.message))}unblockServerByUser(e){this.blocklistService.unblockServerByUser(e).subscribe(()=>{this.notifier.success("\u7AD9\u81FA " + e + " \u5DF2\u89E3\u9664\u975C\u97F3\u3002"),this.account.mutedServerByUser=!1,this.userChanged.emit()},e=>this.notifier.error(e.message))}blockAccountByInstance(e){this.blocklistService.blockAccountByInstance(e).subscribe(()=>{this.notifier.success("\u5E33\u865F " + e.nameWithHost + " \u5DF2\u88AB\u7AD9\u81FA\u975C\u97F3\u3002"),this.account.mutedByInstance=!0,this.userChanged.emit()},e=>this.notifier.error(e.message))}unblockAccountByInstance(e){this.blocklistService.unblockAccountByInstance(e).subscribe(()=>{this.notifier.success("\u5E33\u865F " + e.nameWithHost + " \u5DF2\u88AB\u7AD9\u81FA\u89E3\u9664\u975C\u97F3\u3002"),this.account.mutedByInstance=!1,this.userChanged.emit()},e=>this.notifier.error(e.message))}blockServerByInstance(e){this.blocklistService.blockServerByInstance(e).subscribe(()=>{this.notifier.success("\u7AD9\u81FA " + e + " \u5DF2\u88AB\u7AD9\u81FA\u975C\u97F3\u3002"),this.account.mutedServerByInstance=!0,this.userChanged.emit()},e=>this.notifier.error(e.message))}unblockServerByInstance(e){this.blocklistService.unblockServerByInstance(e).subscribe(()=>{this.notifier.success("\u7AD9\u81FA " + e + " \u5DF2\u88AB\u7AD9\u81FA\u89E3\u9664\u975C\u97F3\u3002"),this.account.mutedServerByInstance=!1,this.userChanged.emit()},e=>this.notifier.error(e.message))}bulkRemoveCommentsOf(e){return Object(n.a)(this,void 0,void 0,function*(){const t="\u60A8\u78BA\u5B9A\u60A8\u60F3\u8981\u79FB\u9664\u6240\u6709\u6B64\u5E33\u865F\u7684\u7559\u8A00\u55CE\uFF1F";!1!==(yield this.confirmService.confirm(t,"\u522A\u9664\u5E33\u865F\u7559\u8A00"))&&this.bulkService.removeCommentsOf(e).subscribe(()=>{this.notifier.success("\u5C07\u6703\u79FB\u9664\u6B64\u5E33\u865F\u7684\u7559\u8A00\uFF08\u53EF\u80FD\u9700\u8981\u6578\u5206\u9418\uFF09\u3002")},e=>this.notifier.error(e.message))})}getRouterUserEditLink(e){return["/admin","users","update",e.id]}buildActions(){if(this.userActions=[],this.prependActions&&(this.userActions=[this.prependActions]),this.authService.isLoggedIn()){const e=this.authService.getUser();if(this.user&&e.id===this.user.id)return;if(this.user&&e.hasRight(1)&&e.canManage(this.user)&&this.userActions.push([{label:"\u7DE8\u8F2F\u4F7F\u7528\u8005",description:"\u8B8A\u66F4\u914D\u984D\u3001\u89D2\u8272\u7B49\u7B49\u3002",linkBuilder:({user:e})=>this.getRouterUserEditLink(e)},{label:"\u522A\u9664\u4F7F\u7528\u8005",description:"\u5F71\u7247\u8207\u7559\u8A00\u90FD\u5C07\u6703\u88AB\u522A\u9664\u3002",handler:({user:e})=>this.removeUser(e)},{label:"\u5C01\u9396",description:"\u4F7F\u7528\u8005\u5C07\u7121\u6CD5\u767B\u5165\uFF0C\u4F46\u5F71\u7247\u8207\u7559\u8A00\u5C07\u6703\u4FDD\u6301\u539F\u6A23\u3002",handler:({user:e})=>this.openBanUserModal(e),isDisplayed:({user:e})=>!e.blocked},{label:"\u53D6\u6D88\u5C01\u9396\u4F7F\u7528\u8005",description:"\u518D\u6B21\u5141\u8A31\u4F7F\u7528\u8005\u767B\u5165\u4E26\u5EFA\u7ACB\u5F71\u7247\uFF0F\u7559\u8A00",handler:({user:e})=>this.unbanUser(e),isDisplayed:({user:e})=>e.blocked},{label:"\u8A2D\u5B9A\u96FB\u5B50\u90F5\u4EF6\u70BA\u5DF2\u9A57\u8B49",handler:({user:e})=>this.setEmailAsVerified(e),isDisplayed:({user:e})=>this.requiresEmailVerification&&!e.blocked&&!1===e.emailVerified}]),this.account){this.userActions.push([{label:"\u975C\u97F3\u6B64\u5E33\u865F",description:"\u5C0D\u60A8\u96B1\u85CF\u8A72\u4F7F\u7528\u8005\u7684\u4EFB\u4F55\u5167\u5BB9\u3002",isDisplayed:({account:e})=>!1===e.mutedByUser,handler:({account:e})=>this.blockAccountByUser(e)},{label:"\u89E3\u9664\u975C\u97F3\u6B64\u5E33\u865F",description:"\u5C0D\u60A8\u986F\u793A\u8A72\u4F7F\u7528\u8005\u7684\u5167\u5BB9\u3002",isDisplayed:({account:e})=>!0===e.mutedByUser,handler:({account:e})=>this.unblockAccountByUser(e)},{label:"\u975C\u97F3\u7AD9\u81FA",description:"\u5C0D\u60A8\u96B1\u85CF\u6B64\u7AD9\u81FA\u7684\u4EFB\u4F55\u5167\u5BB9\u3002",isDisplayed:({account:e})=>!e.userId&&!1===e.mutedServerByInstance,handler:({account:e})=>this.blockServerByUser(e.host)},{label:"\u89E3\u9664\u975C\u97F3\u7AD9\u81FA",description:"\u5C0D\u60A8\u986F\u793A\u8A72\u7AD9\u81FA\u7684\u5167\u5BB9\u3002",isDisplayed:({account:e})=>!e.userId&&!0===e.mutedServerByInstance,handler:({account:e})=>this.unblockServerByUser(e.host)},{label:"\u5F9E\u60A8\u7684\u5F71\u7247\u79FB\u9664\u7559\u8A00",description:"\u79FB\u9664\u60A8\u5F71\u7247\u4E0A\u4EFB\u4F55\u6B64\u5E33\u865F\u505A\u51FA\u7684\u7559\u8A00\u3002",handler:({account:e})=>this.bulkRemoveCommentsOf({accountName:e.nameWithHost,scope:"my-videos"})}]);let t=[];e.hasRight(9)&&(t=t.concat([{label:"\u60A8\u7684\u7AD9\u81FA\u975C\u97F3\u6B64\u5E33\u865F",description:"\u5C0D\u60A8\u3001\u60A8\u7684\u7AD9\u53F0\u8207\u5176\u4F7F\u7528\u8005\u96B1\u85CF\u8A72\u4F7F\u7528\u8005\u7684\u4EFB\u4F55\u5167\u5BB9\u3002",isDisplayed:({account:e})=>!1===e.mutedByInstance,handler:({account:e})=>this.blockAccountByInstance(e)},{label:"\u60A8\u7684\u7AD9\u81FA\u89E3\u9664\u975C\u97F3\u6B64\u5E33\u865F",description:"\u518D\u6B21\u5C0D\u6B64\u7AD9\u53F0\u7684\u4F7F\u7528\u8005\u986F\u793A\u6B64\u4F7F\u7528\u8005\u7684\u5167\u5BB9\u3002",isDisplayed:({account:e})=>!0===e.mutedByInstance,handler:({account:e})=>this.unblockAccountByInstance(e)}])),e.hasRight(10)&&(t=t.concat([{label:"\u60A8\u7684\u7AD9\u81FA\u975C\u97F3\u6B64\u7AD9\u81FA",description:"\u5C0D\u60A8\u3001\u60A8\u7684\u7AD9\u53F0\u8207\u5176\u4F7F\u7528\u8005\u96B1\u85CF\u8A72\u7AD9\u53F0\u7684\u4EFB\u4F55\u5167\u5BB9\u3002",isDisplayed:({account:e})=>!e.userId&&!1===e.mutedServerByInstance,handler:({account:e})=>this.blockServerByInstance(e.host)},{label:"\u60A8\u7684\u7AD9\u81FA\u89E3\u9664\u975C\u97F3\u6B64\u7AD9\u81FA",description:"\u5C0D\u60A8\u3001\u60A8\u7684\u7AD9\u81FA\u8207\u5176\u4F7F\u7528\u8005\u986F\u793A\u8A72\u7AD9\u81FA\u7684\u5167\u5BB9\u3002",isDisplayed:({account:e})=>!e.userId&&!0===e.mutedServerByInstance,handler:({account:e})=>this.unblockServerByInstance(e.host)}])),e.hasRight(15)&&(t=t.concat([{label:"\u5F9E\u60A8\u7684\u7AD9\u81FA\u79FB\u9664\u7559\u8A00",description:"\u5F9E\u60A8\u7684\u7AD9\u53F0\u4E2D\u79FB\u9664\u6B64\u5E33\u865F\u505A\u51FA\u7684\u4EFB\u4F55\u7559\u8A00\u3002",handler:({account:e})=>this.bulkRemoveCommentsOf({accountName:e.nameWithHost,scope:"instance"})}])),0!==t.length&&this.userActions.push(t)}}}}return e.\u0275fac=function(t){return new(t||e)(o.Qb(i.a),o.Qb(i.m),o.Qb(i.d),o.Qb(i.x),o.Qb(i.D),o.Qb(a.b),o.Qb(c.a))},e.\u0275cmp=o.Kb({type:e,selectors:[["my-user-moderation-dropdown"]],viewQuery:function(e,t){if(1&e&&o.Xc(d,1),2&e){let e;o.Hc(e=o.lc())&&(t.userBanModal=e.first)}},inputs:{user:"user",account:"account",prependActions:"prependActions",buttonSize:"buttonSize",placement:"placement",label:"label",container:"container"},outputs:{userChanged:"userChanged",userDeleted:"userDeleted"},features:[o.Bb],decls:1,vars:1,consts:[[4,"ngIf"],[3,"userBanned"],["userBanModal",""],[3,"actions","entry","buttonSize","placement","label","container"]],template:function(e,t){1&e&&o.Rc(0,h,4,9,"ng-container",0),2&e&&o.vc("ngIf",0!==t.userActions.length)},directives:[l.n,s.a,u.a],encapsulation:2}),e})()},"3/ER":function(e,t,r){"use strict";(function(e){var n=r("Ju5/"),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o?n.a.Buffer:void 0,c=a?a.allocUnsafe:void 0;t.a=function(e,t){if(t)return e.slice();var r=e.length,n=c?c(r):new e.constructor(r);return e.copy(n),n}}).call(this,r("3UD+")(e))},"3ZlK":function(e,t,r){"use strict";r.d(t,"a",function(){return n});const n={violentOrRepulsive:1,hatefulOrAbusive:2,spamOrMisleading:3,privacy:4,rights:5,serverRules:6,thumbnails:7,captions:8}},"4/q3":function(e,t,r){"use strict";var n=r("7gMY"),o=r("IzLi"),i=r("pyRK"),a=Object.prototype.hasOwnProperty,c=r("5WsY");t.a=function(e){return Object(c.a)(e)?Object(n.a)(e,!0):function(e){if(!Object(o.a)(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=Object(i.a)(e),r=[];for(var n in e)("constructor"!=n||!t&&a.call(e,n))&&r.push(n);return r}(e)}},"4joM":function(e,t,r){"use strict";r.d(t,"c",function(){return o}),r.d(t,"b",function(){return i}),r.d(t,"a",function(){return a});var n=r("3Pt+");const o={VALIDATORS:[n.w.required,n.w.minLength(2),n.w.maxLength(3e3)],MESSAGES:{required:"\u8209\u5831\u7406\u7531\u5FC5\u586B\u3002",minlength:"\u8209\u5831\u7406\u7531\u5FC5\u9808\u81F3\u5C11 2 \u500B\u5B57\u5143\u9577\u3002",maxlength:"\u8209\u5831\u7406\u7531\u4E0D\u80FD\u591A\u65BC 3000 \u500B\u5B57\u5143\u3002"}},i={VALIDATORS:[n.w.required,n.w.minLength(2),n.w.maxLength(3e3)],MESSAGES:{required:"\u7BA1\u7406\u8A55\u8AD6\u5FC5\u586B\u3002",minlength:"\u7BA1\u7406\u8A55\u8AD6\u5FC5\u9808\u81F3\u5C11 2 \u500B\u5B57\u5143\u3002",maxlength:"\u7BA1\u7406\u7559\u8A00\u4E0D\u80FD\u591A\u65BC 3000 \u500B\u5B57\u5143\u3002"}},a={VALIDATORS:[n.w.required,n.w.minLength(2),n.w.maxLength(3e3)],MESSAGES:{required:"\u6FEB\u7528\u8A0A\u606F\u70BA\u5FC5\u586B\u3002",minlength:"\u6FEB\u7528\u8A0A\u606F\u5FC5\u9808\u81F3\u5C11 2 \u500B\u5B57\u5143\u9577\u3002",maxlength:"\u6FEB\u7528\u8A0A\u606F\u7121\u6CD5\u591A\u65BC 3000 \u500B\u5B57\u5143\u3002"}}},"5WsY":function(e,t,r){"use strict";var n=r("vJtL"),o=r("Js68");t.a=function(e){return null!=e&&Object(o.a)(e.length)&&!Object(n.a)(e)}},"7gMY":function(e,t,r){"use strict";var n=r("9f76"),o=r("/1FC"),i=r("WOAq"),a=r("cSlR"),c=r("oYcn"),s=Object.prototype.hasOwnProperty;t.a=function(e,t){var r=Object(o.a)(e),l=!r&&Object(n.a)(e),u=!r&&!l&&Object(i.a)(e),d=!r&&!l&&!u&&Object(c.a)(e),b=r||l||u||d,h=b?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],f=h.length;for(var m in e)!t&&!s.call(e,m)||b&&("length"==m||u&&("offset"==m||"parent"==m)||d&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||Object(a.a)(m,f))||h.push(m);return h}},"8i4Y":function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"b",function(){return a});var n=r("6rF9"),o=r("xMQD");class i{constructor(e){if(this.id=e.id,this.url=e.url,this.text=e.text,this.threadId=e.threadId,this.inReplyToCommentId=e.inReplyToCommentId,this.videoId=e.videoId,this.createdAt=new Date(e.createdAt.toString()),this.updatedAt=new Date(e.updatedAt.toString()),this.deletedAt=e.deletedAt?new Date(e.deletedAt.toString()):null,this.isDeleted=e.isDeleted,this.account=e.account,this.totalRepliesFromVideoAuthor=e.totalRepliesFromVideoAuthor,this.totalReplies=e.totalReplies,this.account){this.by=o.c.CREATE_BY_STRING(this.account.name,this.account.host),this.accountAvatarUrl=o.a.GET_ACTOR_AVATAR_URL(this.account);const e=Object(n.e)(),t=new URL(e).host;this.isLocal=this.account.host.trim()===t}}}class a{constructor(e,t){this.id=e.id,this.url=e.url,this.text=e.text,this.textHtml=t,this.threadId=e.threadId,this.inReplyToCommentId=e.inReplyToCommentId,this.createdAt=new Date(e.createdAt.toString()),this.updatedAt=new Date(e.updatedAt.toString()),this.video={id:e.video.id,uuid:e.video.uuid,name:e.video.name,localUrl:"/videos/watch/"+e.video.uuid},this.localUrl=this.video.localUrl+";threadId="+this.threadId,this.account=e.account,this.account&&(this.by=o.c.CREATE_BY_STRING(this.account.name,this.account.host),this.accountAvatarUrl=o.a.GET_ACTOR_AVATAR_URL(this.account),this.account.localUrl="/accounts/"+this.by)}}},"9BXX":function(e,t,r){"use strict";r.d(t,"a",function(){return R});var n=r("TSHB"),o=r("u3oV"),i=r("ey9i"),a=r("4joM"),c=r("sWvm"),s=(r("xMQD"),r("3ZlK")),l=r("9dYW"),u=r("fXoL"),d=r("1kSV"),b=r("UkmY"),h=r("3Pt+"),f=r("ofXK"),m=r("/xt7"),p=r("BLxp");const v=["modal"];function g(e,t){if(1&e&&u.Rb(0,"div",26),2&e){const e=u.oc(2).$implicit;u.vc("innerHTML",e.help,u.Lc)}}function y(e,t){1&e&&u.Rc(0,g,1,1,"ng-template",25)}function S(e,t){if(1&e&&(u.Ub(0,27),u.Rb(1,"div",26),u.Tb()),2&e){const e=u.oc().$implicit;u.Db(1),u.vc("innerHTML",e.description,u.Lc)}}function O(e,t){if(1&e&&(u.Wb(0,"div",17),u.Wb(1,"my-peertube-checkbox",23),u.Rc(2,y,1,0,void 0,16),u.Rc(3,S,2,1,"ng-container",24),u.Vb(),u.Vb()),2&e){const e=t.$implicit;u.Db(1),u.vc("inputName",e.id)("formControlName",e.id)("labelText",e.label),u.Db(1),u.vc("ngIf",e.help),u.Db(1),u.vc("ngIf",e.description)}}function A(e,t){if(1&e&&(u.gc(0,15,1),u.Sb(1),u.dc()),2&e){const e=u.oc(2);u.Db(1),u.ec(e.originHost),u.bc(0)}}function j(e,t){if(1&e&&(u.Wb(0,"div",28),u.Tc(1),u.Vb()),2&e){const e=u.oc(2);u.Db(1),u.Vc(" ",e.formErrors.reason," ")}}const E=function(e){return{"input-error":e}};function x(e,t){if(1&e){const e=u.Xb();u.Wb(0,"div",1),u.Wb(1,"h4",2),u.Tc(2),u.Vb(),u.Wb(3,"my-global-icon",3),u.kc("click",function(){return u.Kc(e),u.oc().hide()}),u.Vb(),u.Vb(),u.Wb(4,"div",4),u.Wb(5,"form",5),u.kc("ngSubmit",function(){return u.Kc(e),u.oc().report()}),u.Wb(6,"div",6),u.Wb(7,"div",7),u.Wb(8,"label",8),u.ac(9,9),u.Vb(),u.Wb(10,"div",10),u.Ub(11,11),u.Rc(12,O,4,5,"div",12),u.Tb(),u.Vb(),u.Vb(),u.Wb(13,"div",13),u.Wb(14,"div",14),u.gc(15,15),u.Rc(16,A,2,1,"ng-container",16),u.dc(),u.Vb(),u.Wb(17,"div",17),u.Rb(18,"textarea",18),u.Rc(19,j,2,1,"div",19),u.Vb(),u.Vb(),u.Vb(),u.Wb(20,"div",20),u.Wb(21,"input",21),u.kc("click",function(){return u.Kc(e),u.oc().hide()})("key.enter",function(){return u.Kc(e),u.oc().hide()}),u.Vb(),u.Rb(22,"input",22),u.Vb(),u.Vb(),u.Vb()}if(2&e){const e=u.oc();u.Db(2),u.Uc(e.modalTitle),u.Db(3),u.vc("formGroup",e.form),u.Db(7),u.vc("ngForOf",e.predefinedReasons),u.Db(4),u.vc("ngIf",e.isRemote()),u.ec(e.currentHost),u.bc(15),u.Db(2),u.vc("ngClass",u.zc(8,E,e.formErrors.reason)),u.Db(1),u.vc("ngIf",e.formErrors.reason),u.Db(3),u.vc("disabled",!e.form.valid)}}let R=(()=>{class e extends c.a{constructor(e,t,r,n){super(),this.formValidatorService=e,this.modalService=t,this.abuseService=r,this.notifier=n,this.account=null,this.error=null,this.predefinedReasons=[]}get currentHost(){return window.location.host}get originHost(){return this.isRemote()?this.account.host:""}ngOnInit(){this.modalTitle="\u56DE\u5831 " + this.account.displayName + " ",this.buildForm({reason:a.c,predefinedReasons:Object(n.a)(s.a,e=>null)}),this.predefinedReasons=this.abuseService.getPrefefinedReasons("account")}show(){this.openedModal=this.modalService.open(this.modal,{centered:!0,keyboard:!1,size:"lg"})}hide(){this.openedModal.close(),this.openedModal=null}report(){const e=this.form.get("reason").value,t=Object.keys(Object(o.a)(this.form.get("predefinedReasons").value));this.abuseService.reportVideo({reason:e,predefinedReasons:t,account:{id:this.account.id}}).subscribe(()=>{this.notifier.success("\u5E33\u865F\u5DF2\u56DE\u5831\u3002"),this.hide()},e=>this.notifier.error(e.message))}isRemote(){return!this.account.isLocal}}return e.\u0275fac=function(t){return new(t||e)(u.Qb(c.b),u.Qb(d.o),u.Qb(l.a),u.Qb(i.m))},e.\u0275cmp=u.Kb({type:e,selectors:[["my-account-report"]],viewQuery:function(e,t){if(1&e&&u.Xc(v,3),2&e){let e;u.Hc(e=u.lc())&&(t.modal=e.first)}},inputs:{account:"account"},features:[u.Ab],decls:2,vars:0,consts:function(){let e,t,r,n,o;return e="\u4EC0\u9EBC\u554F\u984C\uFF1F",t="\u8ACB\u63CF\u8FF0\u554F\u984C\u2026\u2026",r="\u53D6\u6D88",n="\u905E\u4EA4",o="\u60A8\u7684\u56DE\u5831\u5C07\u6703\u50B3\u9001\u7D66 " + "\ufffd0\ufffd" + "" + "\ufffd*16:1\ufffd\ufffd#1:1\ufffd" + " \u7684\u677F\u4E3B\u4E14\u4E5F\u6703\u8F49\u767C\u7D66\u7559\u8A00\u7684\u539F\u59CB\u4F86\u6E90 (" + "\ufffd0:1\ufffd" + ") " + "\ufffd/#1:1\ufffd\ufffd/*16:1\ufffd" + "\u3002 ",[["modal",""],[1,"modal-header"],[1,"modal-title"],["iconName","cross","aria-label","Close","role","button",3,"click"],[1,"modal-body"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-5","form-group"],["for","reportPredefinedReasons"],e,[1,"ml-2","mt-2","d-flex","flex-column"],["formGroupName","predefinedReasons"],["class","form-group",4,"ngFor","ngForOf"],[1,"col-7"],[1,"information"],o,[4,"ngIf"],[1,"form-group"],["placeholder",t,"formControlName","reason","ngbAutofocus","",1,"form-control",3,"ngClass"],["class","form-error",4,"ngIf"],[1,"form-group","inputs"],["type","button","role","button","value",r,1,"action-button","action-button-cancel",3,"click","key.enter"],["type","submit","value",n,1,"action-button-submit",3,"disabled"],[3,"inputName","formControlName","labelText"],["ngProjectAs","description",5,["description"],4,"ngIf"],["ptTemplate","help"],[3,"innerHTML"],["ngProjectAs","description",5,["description"]],[1,"form-error"]]},template:function(e,t){1&e&&u.Rc(0,x,23,10,"ng-template",null,0,u.Sc)},directives:[b.a,h.y,h.n,h.h,h.i,f.m,f.n,h.b,h.m,h.f,f.l,m.a,p.a],styles:[".information[_ngcontent-%COMP%]{margin-bottom:20px}textarea[_ngcontent-%COMP%]{display:inline-block;height:30px;width:100%;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid #c6c6c6;border-radius:3px;color:var(--textareaForegroundColor);background-color:var(--textareaBackgroundColor);height:100px;padding:5px 15px;font-size:15px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}textarea[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width:100%){textarea[_ngcontent-%COMP%]{width:100%}}.start-at[_ngcontent-%COMP%], .stop-at[_ngcontent-%COMP%]{width:300px;display:flex;align-items:center}.start-at[_ngcontent-%COMP%]   my-timestamp-input[_ngcontent-%COMP%], .stop-at[_ngcontent-%COMP%]   my-timestamp-input[_ngcontent-%COMP%]{margin-left:10px}.screenratio[_ngcontent-%COMP%]{position:relative;height:0;width:100%;padding-top:56%}.screenratio[_ngcontent-%COMP%]     iframe, .screenratio[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0}"]}),e})()},"9dYW":function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r("m8R6"),o=r("JIr8"),i=r("lJxs"),a=r("tk/3"),c=r("ey9i"),s=r("AytR"),l=r("fXoL");let u=(()=>{class e{constructor(e,t,r){this.authHttp=e,this.restService=t,this.restExtractor=r}getAdminAbuses(t){const{pagination:r,sort:n,search:i}=t,c=e.BASE_ABUSE_URL;let s=new a.f;return s=this.restService.addRestGetParams(s,r,n),i&&(s=this.buildParamsFromSearch(i,s)),this.authHttp.get(c,{params:s}).pipe(Object(o.a)(e=>this.restExtractor.handleError(e)))}getUserAbuses(t){const{pagination:r,sort:n,search:i}=t,c=e.BASE_MY_ABUSE_URL;let s=new a.f;return s=this.restService.addRestGetParams(s,r,n),i&&(s=this.buildParamsFromSearch(i,s)),this.authHttp.get(c,{params:s}).pipe(Object(o.a)(e=>this.restExtractor.handleError(e)))}reportVideo(t){const r=e.BASE_ABUSE_URL,a=Object(n.a)(t,["id"]);return this.authHttp.post(r,a).pipe(Object(i.a)(this.restExtractor.extractDataBool),Object(o.a)(e=>this.restExtractor.handleError(e)))}updateAbuse(t,r){return this.authHttp.put(e.BASE_ABUSE_URL+"/"+t.id,r).pipe(Object(i.a)(this.restExtractor.extractDataBool),Object(o.a)(e=>this.restExtractor.handleError(e)))}removeAbuse(t){return this.authHttp.delete(e.BASE_ABUSE_URL+"/"+t.id).pipe(Object(i.a)(this.restExtractor.extractDataBool),Object(o.a)(e=>this.restExtractor.handleError(e)))}addAbuseMessage(t,r){return this.authHttp.post(e.BASE_ABUSE_URL+"/"+t.id+"/messages",{message:r}).pipe(Object(i.a)(this.restExtractor.extractDataBool),Object(o.a)(e=>this.restExtractor.handleError(e)))}listAbuseMessages(t){return this.authHttp.get(e.BASE_ABUSE_URL+"/"+t.id+"/messages").pipe(Object(o.a)(e=>this.restExtractor.handleError(e)))}deleteAbuseMessage(t,r){return this.authHttp.delete(e.BASE_ABUSE_URL+"/"+t.id+"/messages/"+r.id).pipe(Object(i.a)(this.restExtractor.extractDataBool),Object(o.a)(e=>this.restExtractor.handleError(e)))}getPrefefinedReasons(e){let t=[{id:"violentOrRepulsive",label:"\u66B4\u529B\u6216\u4EE4\u4EBA\u53AD\u60E1",help:"\u5305\u542B\u4EE4\u4EBA\u53CD\u611F\u3001\u66B4\u529B\u3001\u7C97\u4FD7\u7684\u8A9E\u8A00\u6216\u5F71\u50CF\u3002"},{id:"hatefulOrAbusive",label:"\u4EC7\u6068\u8A00\u8AD6",help:"\u5305\u542B\u4FAE\u8FB1\u3001\u7A2E\u65CF\u4E3B\u7FA9\u3001\u6027\u5225\u6B67\u8996\u8A00\u8AD6\u6216\u5F71\u50CF\u3002"},{id:"spamOrMisleading",label:"\u5783\u573E\u8A0A\u606F\u3001\u5EE3\u544A\u6216\u5047\u65B0\u805E",help:"\u5305\u542B\u884C\u92B7\u3001\u5783\u573E\u8A0A\u606F\u3001\u8A50\u6B3A\u65B0\u805E\u6216\u5176\u4ED6\u7684\u8AA4\u5C0E\u6027\u7E2E\u5716\uFF0F\u6587\u5B57\uFF0F\u6A19\u7C64\u3002\u8ACB\u63D0\u4F9B\u4FE1\u8B7D\u826F\u597D\u7684\u4F86\u6E90\u4EE5\u56DE\u5831\u8A50\u9A19\u3002"},{id:"privacy",label:"\u4FB5\u72AF\u96B1\u79C1\u6216\u6D29\u6F0F",help:"\u5305\u542B\u53EF\u80FD\u6703\u88AB\u7528\u65BC\u8FFD\u8E64\u3001\u8B58\u5225\u3001\u806F\u7D61\u6216\u5047\u5192\u67D0\u4EBA\u7684\u500B\u4EBA\u8CC7\u8A0A\uFF08\u5982\u540D\u5B57\u3001\u5730\u5740\u3001\u96FB\u8A71\u865F\u78BC\u3001\u96FB\u5B50\u90F5\u4EF6\u6216\u4FE1\u7528\u5361\u8CC7\u8A0A\u7B49\uFF09\u3002"},{id:"rights",label:"\u8457\u4F5C\u6B0A",help:"\u4FB5\u72AF\u60A8\u7684\u8457\u4F5C\u6B0A\uFF0C\u4E14\u5FC5\u9808\u9075\u5B88\u4F3A\u670D\u5668\u6240\u5728\u5730\u7684\u6CD5\u5F8B\u3002"},{id:"serverRules",label:"\u7834\u58DE\u4F3A\u670D\u5668\u898F\u5247",description:"\u4E0D\u5728\u4E0A\u65B9\u6240\u63D0\u5230\u7684\u4EFB\u4F55\u7834\u58DE\u670D\u52D9\u689D\u6B3E\u3001\u884C\u70BA\u6E96\u5247\u6216\u4F3A\u670D\u6C23\u4E0A\u4E00\u822C\u898F\u5247\u7684\u5167\u5BB9\u3002"}];return"video"===e&&(t=t.concat([{id:"thumbnails",label:"\u7E2E\u5716",help:"\u4EE5\u4E0A\u5167\u5BB9\u53EA\u80FD\u5728\u7E2E\u5716\u4E2D\u770B\u5230\u3002"},{id:"captions",label:"\u5B57\u5E55",help:"\u4EE5\u4E0A\u5167\u5BB9\u53EA\u80FD\u5728\u6A19\u984C\u4E2D\u770B\u5230\uFF08\u8ACB\u8AAA\u660E\uFF09\u3002"}])),t}buildParamsFromSearch(e,t){const r=this.restService.parseQueryStringFilter(e,{id:{prefix:"#"},state:{prefix:"state:",handler:e=>"accepted"===e?3:"pending"===e?1:"rejected"===e?2:void 0},videoIs:{prefix:"videoIs:",handler:e=>"deleted"===e||"blacklisted"===e?e:void 0},searchReporter:{prefix:"reporter:"},searchReportee:{prefix:"reportee:"},predefinedReason:{prefix:"tag:"}});return this.restService.addObjectParams(t,r)}}return e.BASE_ABUSE_URL=s.a.apiUrl+"/api/v1/abuses",e.BASE_MY_ABUSE_URL=s.a.apiUrl+"/api/v1/users/me/abuses",e.\u0275fac=function(t){return new(t||e)(l.hc(a.b),l.hc(c.s),l.hc(c.r))},e.\u0275prov=l.Mb({token:e,factory:e.\u0275fac}),e})()},BYvb:function(e,t,r){"use strict";r.d(t,"a",function(){return C});var n=r("TSHB"),o=r("u3oV"),i=r("H9+z"),a=r("ey9i"),c=r("4joM"),s=r("sWvm"),l=r("3ZlK"),u=(r("xMQD"),r("9dYW")),d=r("fXoL"),b=r("1kSV"),h=r("jhN1"),f=r("UkmY"),m=r("3Pt+"),p=r("ofXK"),v=r("/xt7"),g=r("C8Cb"),y=r("BLxp");const S=["modal"];function O(e,t){if(1&e&&d.Rb(0,"div",18),2&e){const e=d.oc(2).$implicit;d.vc("innerHTML",e.help,d.Lc)}}function A(e,t){1&e&&d.Rc(0,O,1,1,"ng-template",34)}function j(e,t){if(1&e&&(d.Ub(0,35),d.Rb(1,"div",18),d.Tb()),2&e){const e=d.oc().$implicit;d.Db(1),d.vc("innerHTML",e.description,d.Lc)}}function E(e,t){if(1&e&&(d.Wb(0,"div",26),d.Wb(1,"my-peertube-checkbox",32),d.Rc(2,A,1,0,void 0,25),d.Rc(3,j,2,1,"ng-container",33),d.Vb(),d.Vb()),2&e){const e=t.$implicit;d.Db(1),d.vc("inputName",e.id)("formControlName",e.id)("labelText",e.label),d.Db(1),d.vc("ngIf",e.help),d.Db(1),d.vc("ngIf",e.description)}}function x(e,t){if(1&e&&(d.Wb(0,"div",36),d.Rb(1,"my-peertube-checkbox",37),d.Rb(2,"my-timestamp-input",38),d.Vb()),2&e){const e=d.oc(2);d.Db(2),d.vc("timestamp",e.timestamp.endAt)("maxTimestamp",e.video.duration)}}function R(e,t){if(1&e&&(d.gc(0,24,1),d.Sb(1),d.dc()),2&e){const e=d.oc(2);d.Db(1),d.ec(e.originHost),d.bc(0)}}function k(e,t){if(1&e&&(d.Wb(0,"div",39),d.Tc(1),d.Vb()),2&e){const e=d.oc(2);d.Db(1),d.Vc(" ",e.formErrors.reason," ")}}const w=function(e){return{"input-error":e}};function _(e,t){if(1&e){const e=d.Xb();d.Wb(0,"div",1),d.Wb(1,"h4",2),d.ac(2,3),d.Vb(),d.Wb(3,"my-global-icon",4),d.kc("click",function(){return d.Kc(e),d.oc().hide()}),d.Vb(),d.Vb(),d.Wb(4,"div",5),d.Wb(5,"form",6),d.kc("ngSubmit",function(){return d.Kc(e),d.oc().report()}),d.Wb(6,"div",7),d.Wb(7,"div",8),d.Wb(8,"label",9),d.ac(9,10),d.Vb(),d.Wb(10,"div",11),d.Ub(11,12),d.Rc(12,E,4,5,"div",13),d.Tb(),d.Vb(),d.Vb(),d.Wb(13,"div",14),d.Wb(14,"div",15),d.Wb(15,"div",16),d.Wb(16,"div",17),d.Rb(17,"div",18),d.Vb(),d.Vb(),d.Vb(),d.Wb(18,"div",19),d.Rb(19,"my-peertube-checkbox",20),d.Rb(20,"my-timestamp-input",21),d.Vb(),d.Rc(21,x,3,2,"div",22),d.Wb(22,"div",23),d.gc(23,24),d.Rc(24,R,2,1,"ng-container",25),d.dc(),d.Vb(),d.Wb(25,"div",26),d.Rb(26,"textarea",27),d.Rc(27,k,2,1,"div",28),d.Vb(),d.Vb(),d.Vb(),d.Wb(28,"div",29),d.Wb(29,"input",30),d.kc("click",function(){return d.Kc(e),d.oc().hide()})("key.enter",function(){return d.Kc(e),d.oc().hide()}),d.Vb(),d.Rb(30,"input",31),d.Vb(),d.Vb(),d.Vb()}if(2&e){const e=d.oc();d.Db(2),d.ec(e.video.name),d.bc(2),d.Db(3),d.vc("formGroup",e.form),d.Db(7),d.vc("ngForOf",e.predefinedReasons),d.Db(5),d.vc("innerHTML",e.embedHtml,d.Lc),d.Db(3),d.vc("timestamp",e.timestamp.startAt)("maxTimestamp",e.video.duration),d.Db(1),d.vc("ngIf",e.timestamp.hasStart),d.Db(3),d.vc("ngIf",e.isRemote()),d.ec(e.currentHost),d.bc(23),d.Db(2),d.vc("ngClass",d.zc(12,w,e.formErrors.reason)),d.Db(1),d.vc("ngIf",e.formErrors.reason),d.Db(3),d.vc("disabled",!e.form.valid)}}let C=(()=>{class e extends s.a{constructor(e,t,r,n,o){super(),this.formValidatorService=e,this.modalService=t,this.abuseService=r,this.notifier=n,this.sanitizer=o,this.video=null,this.error=null,this.predefinedReasons=[]}get currentHost(){return window.location.host}get originHost(){return this.isRemote()?this.video.account.host:""}get timestamp(){return this.form.get("timestamp").value}getVideoEmbed(){return this.sanitizer.bypassSecurityTrustHtml(Object(i.c)(Object(i.b)({baseUrl:this.video.embedUrl,title:!1,warningTitle:!1})))}ngOnInit(){this.buildForm({reason:c.c,predefinedReasons:Object(n.a)(l.a,e=>null),timestamp:{hasStart:null,startAt:null,hasEnd:null,endAt:null}}),this.predefinedReasons=this.abuseService.getPrefefinedReasons("video"),this.embedHtml=this.getVideoEmbed()}show(){this.openedModal=this.modalService.open(this.modal,{centered:!0,keyboard:!1,size:"lg"})}hide(){this.openedModal.close(),this.openedModal=null}report(){const e=this.form.get("reason").value,t=Object.keys(Object(o.a)(this.form.get("predefinedReasons").value)),{hasStart:r,startAt:n,hasEnd:i,endAt:a}=this.form.get("timestamp").value;this.abuseService.reportVideo({reason:e,predefinedReasons:t,video:{id:this.video.id,startAt:r&&n?n:void 0,endAt:i&&a?a:void 0}}).subscribe(()=>{this.notifier.success("\u5F71\u7247\u5DF2\u56DE\u5831\u3002"),this.hide()},e=>this.notifier.error(e.message))}isRemote(){return!this.video.isLocal}}return e.\u0275fac=function(t){return new(t||e)(d.Qb(s.b),d.Qb(b.o),d.Qb(u.a),d.Qb(a.m),d.Qb(h.b))},e.\u0275cmp=d.Kb({type:e,selectors:[["my-video-report"]],viewQuery:function(e,t){if(1&e&&d.Xc(S,3),2&e){let e;d.Hc(e=d.lc())&&(t.modal=e.first)}},inputs:{video:"video"},features:[d.Ab],decls:2,vars:0,consts:function(){let e,t,r,n,o,i,a,c;return e="\u56DE\u5831\u5F71\u7247 \"" + "\ufffd0\ufffd" + "\"",t="\u4EC0\u9EBC\u554F\u984C\uFF1F",r="\u958B\u59CB\u65BC",n="\u8ACB\u63CF\u8FF0\u554F\u984C\u2026\u2026",o="\u53D6\u6D88",i="\u905E\u4EA4",a="\u505C\u6B62\u65BC",c="\u60A8\u7684\u56DE\u5831\u5C07\u6703\u50B3\u9001\u7D66 " + "\ufffd0\ufffd" + "" + "\ufffd*24:1\ufffd\ufffd#1:1\ufffd" + " \u7684\u7BA1\u7406\u54E1\uFF0C\u4E5F\u6703\u8F49\u767C\u7D66\u5F71\u7247\u4F86\u6E90 (" + "\ufffd0:1\ufffd" + ")" + "\ufffd/#1:1\ufffd\ufffd/*24:1\ufffd" + ". ",[["modal",""],[1,"modal-header"],[1,"modal-title"],e,["iconName","cross","aria-label","Close","role","button",3,"click"],[1,"modal-body"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-5","form-group"],["for","reportPredefinedReasons"],t,[1,"ml-2","mt-2","d-flex","flex-column"],["formGroupName","predefinedReasons"],["class","form-group",4,"ngFor","ngForOf"],[1,"col-7"],[1,"row","justify-content-center"],[1,"col-12","col-lg-9","mb-2"],[1,"screenratio"],[3,"innerHTML"],["formGroupName","timestamp",1,"mb-1","start-at"],["formControlName","hasStart","labelText",r],["formControlName","startAt","inputName","startAt",3,"timestamp","maxTimestamp"],["class","mb-3 stop-at","formGroupName","timestamp",4,"ngIf"],[1,"information"],c,[4,"ngIf"],[1,"form-group"],["placeholder",n,"formControlName","reason","ngbAutofocus","",1,"form-control",3,"ngClass"],["class","form-error",4,"ngIf"],[1,"form-group","inputs"],["type","button","role","button","value",o,1,"action-button","action-button-cancel",3,"click","key.enter"],["type","submit","value",i,1,"action-button-submit",3,"disabled"],[3,"inputName","formControlName","labelText"],["ngProjectAs","description",5,["description"],4,"ngIf"],["ptTemplate","help"],["ngProjectAs","description",5,["description"]],["formGroupName","timestamp",1,"mb-3","stop-at"],["formControlName","hasEnd","labelText",a],["formControlName","endAt","inputName","endAt",3,"timestamp","maxTimestamp"],[1,"form-error"]]},template:function(e,t){1&e&&d.Rc(0,_,31,14,"ng-template",null,0,d.Sc)},directives:[f.a,m.y,m.n,m.h,m.i,p.m,v.a,m.m,m.f,g.a,p.n,m.b,p.l,y.a],styles:[".information[_ngcontent-%COMP%]{margin-bottom:20px}textarea[_ngcontent-%COMP%]{display:inline-block;height:30px;width:100%;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid #c6c6c6;border-radius:3px;color:var(--textareaForegroundColor);background-color:var(--textareaBackgroundColor);height:100px;padding:5px 15px;font-size:15px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}textarea[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width:100%){textarea[_ngcontent-%COMP%]{width:100%}}.start-at[_ngcontent-%COMP%], .stop-at[_ngcontent-%COMP%]{width:300px;display:flex;align-items:center}.start-at[_ngcontent-%COMP%]   my-timestamp-input[_ngcontent-%COMP%], .stop-at[_ngcontent-%COMP%]   my-timestamp-input[_ngcontent-%COMP%]{margin-left:10px}.screenratio[_ngcontent-%COMP%]{position:relative;height:0;width:100%;padding-top:56%}.screenratio[_ngcontent-%COMP%]     iframe, .screenratio[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0}"]}),e})()},Ce4a:function(e,t,r){"use strict";var n=r("Ju5/");t.a=n.a.Uint8Array},"E/r9":function(e,t,r){"use strict";r.d(t,"a",function(){return g});var n=r("fXoL"),o=r("sWvm"),i=r("3Pt+");function a(e){return e.split("\n").filter(e=>e&&0!==e.length)}const c={VALIDATORS:[i.w.required,e=>{if(!e.value)return null;const t=[],r=a(e.value);for(const o of r)!1===(n=o,new RegExp("^(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]*[a-zA-Z0-9]).)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$").test(n))&&t.push("\n          " + o + " \u7121\u6548\n        ");var n;return 0!==t.length?{validDomains:{reason:"invalid",value:t.join(". ")+"."}}:null},e=>{if(!e.value)return null;const t=a(e.value);return t.every(e=>t.indexOf(e)===t.lastIndexOf(e))?null:{uniqueDomains:{reason:"invalid"}}}],MESSAGES:{required:"\u7DB2\u57DF\u5FC5\u586B\u3002",validDomains:"\u8F38\u5165\u7684\u57DF\u540D\u7121\u6548\u3002",uniqueDomains:"\u8F38\u5165\u7684\u57DF\u540D\u5305\u542B\u91CD\u8986\u7684\u9805\u76EE\u3002"}};var s=r("1kSV"),l=r("UkmY"),u=r("ofXK");const d=["modal"];function b(e,t){if(1&e&&(n.Wb(0,"div"),n.Tc(1),n.Vb()),2&e){const e=n.oc(3);n.Db(1),n.Vc(" ",e.form.controls.domains.errors.validDomains.value," ")}}function h(e,t){if(1&e&&(n.Wb(0,"div",15),n.Tc(1),n.Rc(2,b,2,1,"div",16),n.Vb()),2&e){const e=n.oc(2);n.Db(1),n.Vc(" ",e.formErrors.domains," "),n.Db(1),n.vc("ngIf",e.form.controls.domains.errors.validDomains)}}const f=function(e){return{"input-error":e}};function m(e,t){if(1&e){const e=n.Xb();n.Wb(0,"div",1),n.Wb(1,"h4",2),n.ac(2,3),n.Vb(),n.Wb(3,"my-global-icon",4),n.kc("click",function(){return n.Kc(e),n.oc().hide()}),n.Vb(),n.Vb(),n.Wb(4,"div",5),n.Wb(5,"form",6),n.kc("ngSubmit",function(){return n.Kc(e),n.oc().submit()}),n.Wb(6,"div",7),n.Wb(7,"label",8),n.ac(8,9),n.Vb(),n.Rb(9,"textarea",10),n.Rc(10,h,3,2,"div",11),n.Vb(),n.tc(11),n.Wb(12,"div",12),n.Wb(13,"input",13),n.kc("click",function(){return n.Kc(e),n.oc().hide()})("key.enter",function(){return n.Kc(e),n.oc().hide()}),n.Vb(),n.Rb(14,"input",14),n.Vb(),n.Vb(),n.Vb()}if(2&e){const e=n.oc();n.Db(2),n.ec(e.action),n.bc(2),n.Db(3),n.vc("formGroup",e.form),n.Db(4),n.vc("placeholder",e.placeholder)("ngClass",n.zc(7,f,e.formErrors.domains)),n.Db(1),n.vc("ngIf",e.formErrors.domains),n.Db(4),n.vc("value",e.action)("disabled",!e.form.valid)}}const p=[[["warning"]]],v=["warning"];let g=(()=>{class e extends o.a{constructor(e,t){super(),this.formValidatorService=e,this.modalService=t,this.placeholder="example.com",this.domains=new n.n}ngOnInit(){this.action||(this.action="\u8655\u7406\u7DB2\u57DF"),this.buildForm({domains:c})}openModal(){this.openedModal=this.modalService.open(this.modal,{centered:!0})}hide(){this.openedModal.close()}submit(){this.domains.emit(a(this.form.controls.domains.value)),this.form.reset(),this.hide()}}return e.\u0275fac=function(t){return new(t||e)(n.Qb(o.b),n.Qb(s.o))},e.\u0275cmp=n.Kb({type:e,selectors:[["my-batch-domains-modal"]],viewQuery:function(e,t){if(1&e&&n.Xc(d,3),2&e){let e;n.Hc(e=n.lc())&&(t.modal=e.first)}},inputs:{placeholder:"placeholder",action:"action"},outputs:{domains:"domains"},features:[n.Ab],ngContentSelectors:v,decls:2,vars:0,consts:function(){let e,t,r;return e="\n          " + "\ufffd0\ufffd" + "\n        ",t="\u6BCF\u884C\u4E00\u500B\u4E3B\u6A5F\uFF08\u4E0D\u9700\u8981 \"http://\"\uFF09",r="\u53D6\u6D88",[["modal",""],[1,"modal-header"],[1,"modal-title"],e,["iconName","cross","aria-label","Close","role","button",3,"click"],[1,"modal-body"],["novalidate","",3,"formGroup","ngSubmit"],[1,"form-group"],["for","hosts"],t,["formControlName","domains","type","text","id","hosts","name","hosts","ngbAutofocus","",1,"form-control",3,"placeholder","ngClass"],["class","form-error",4,"ngIf"],[1,"form-group","inputs"],["type","button","role","button","value",r,1,"action-button","action-button-cancel",3,"click","key.enter"],["type","submit",1,"action-button-submit",3,"value","disabled"],[1,"form-error"],[4,"ngIf"]]},template:function(e,t){1&e&&(n.uc(p),n.Rc(0,m,15,9,"ng-template",null,0,n.Sc))},directives:[l.a,i.y,i.n,i.h,i.b,i.m,i.f,u.l,u.n],styles:["textarea[_ngcontent-%COMP%]{height:200px}"]}),e})()},GYlH:function(e,t,r){"use strict";t.a=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}},GeT4:function(e,t,r){"use strict";r.d(t,"a",function(){return f});var n=r("Cfvw"),o=r("lJxs"),i=r("JIr8"),a=r("bOdf"),c=r("IAdc"),s=r("tk/3"),l=r("ey9i"),u=r("6rF9"),d=r("AytR"),b=r("8i4Y"),h=r("fXoL");let f=(()=>{class e{constructor(e,t,r){this.authHttp=e,this.restExtractor=t,this.restService=r}addCommentThread(t,r){const n=e.BASE_VIDEO_URL+t+"/comment-threads",a=Object(u.m)(r,"text");return this.authHttp.post(n,a).pipe(Object(o.a)(e=>this.extractVideoComment(e.comment)),Object(i.a)(e=>this.restExtractor.handleError(e)))}addCommentReply(t,r,n){const a=e.BASE_VIDEO_URL+t+"/comments/"+r,c=Object(u.m)(n,"text");return this.authHttp.post(a,c).pipe(Object(o.a)(e=>this.extractVideoComment(e.comment)),Object(i.a)(e=>this.restExtractor.handleError(e)))}getAdminVideoComments(t){const{pagination:r,sort:n,search:o}=t,a=e.BASE_VIDEO_URL+"comments";let c=new s.f;return c=this.restService.addRestGetParams(c,r,n),o&&(c=this.buildParamsFromSearch(o,c)),this.authHttp.get(a,{params:c}).pipe(Object(i.a)(e=>this.restExtractor.handleError(e)))}getVideoCommentThreads(t){const{videoId:r,componentPagination:n,sort:a}=t,c=this.restService.componentPaginationToRestPagination(n);let l=new s.f;return l=this.restService.addRestGetParams(l,c,a),this.authHttp.get(e.BASE_VIDEO_URL+r+"/comment-threads",{params:l}).pipe(Object(o.a)(e=>this.extractVideoComments(e)),Object(i.a)(e=>this.restExtractor.handleError(e)))}getVideoThreadComments(t){const{videoId:r,threadId:n}=t;return this.authHttp.get(`${e.BASE_VIDEO_URL+r}/comment-threads/${n}`).pipe(Object(o.a)(e=>this.extractVideoCommentTree(e)),Object(i.a)(e=>this.restExtractor.handleError(e)))}deleteVideoComment(t,r){return this.authHttp.delete(`${e.BASE_VIDEO_URL+t}/comments/${r}`).pipe(Object(o.a)(this.restExtractor.extractDataBool),Object(i.a)(e=>this.restExtractor.handleError(e)))}deleteVideoComments(e){return Object(n.a)(e).pipe(Object(a.a)(e=>this.deleteVideoComment(e.videoId,e.commentId)),Object(c.a)())}getVideoCommentsFeeds(t){const r=[{format:"xml",label:"rss 2.0",url:e.BASE_FEEDS_URL+"xml".toLowerCase()},{format:"atom",label:"atom 1.0",url:e.BASE_FEEDS_URL+"atom".toLowerCase()},{format:"json",label:"json 1.0",url:e.BASE_FEEDS_URL+"json".toLowerCase()}];if(void 0!==t)for(const e of r)e.url+="?videoId="+t;return r}extractVideoComment(e){return new b.a(e)}extractVideoComments(e){const t=e.data,r=e.total,n=[];for(const o of t)n.push(new b.a(o));return{data:n,total:r,totalNotDeletedComments:e.totalNotDeletedComments}}extractVideoCommentTree(e){if(!e)return null;const t={comment:new b.a(e.comment),children:e.children.map(e=>this.extractVideoCommentTree(e))},r=0===t.children.length?!t.comment.isDeleted:t.children.some(e=>e.hasDisplayedChildren);return Object.assign(t,{hasDisplayedChildren:r})}buildParamsFromSearch(e,t){const r=this.restService.parseQueryStringFilter(e,{isLocal:{prefix:"local:",isBoolean:!0,handler:e=>"true"===e||"false"===e?e:void 0},searchAccount:{prefix:"account:"},searchVideo:{prefix:"video:"}});return this.restService.addObjectParams(t,r)}}return e.BASE_FEEDS_URL=d.a.apiUrl+"/feeds/video-comments.",e.BASE_VIDEO_URL=d.a.apiUrl+"/api/v1/videos/",e.\u0275fac=function(t){return new(t||e)(h.hc(s.b),h.hc(l.r),h.hc(l.s))},e.\u0275prov=h.Mb({token:e,factory:e.\u0275fac}),e})()},GxWh:function(e,t,r){"use strict";r.d(t,"a",function(){return u}),r.d(t,"b",function(){return d});var n=r("lJxs"),o=r("JIr8"),i=r("tk/3"),a=r("ey9i"),c=r("AytR"),s=r("xHIW"),l=r("fXoL"),u=function(e){return e[e.Account=0]="Account",e[e.Instance=1]="Instance",e}({});let d=(()=>{class e{constructor(e,t,r){this.authHttp=e,this.restExtractor=t,this.restService=r}getUserAccountBlocklist(t){const{pagination:r,sort:a,search:c}=t;let s=new i.f;return s=this.restService.addRestGetParams(s,r,a),c&&(s=s.append("search",c)),this.authHttp.get(e.BASE_USER_BLOCKLIST_URL+"/accounts",{params:s}).pipe(Object(n.a)(e=>this.restExtractor.convertResultListDateToHuman(e)),Object(n.a)(e=>this.restExtractor.applyToResultListData(e,this.formatAccountBlock.bind(this))),Object(o.a)(e=>this.restExtractor.handleError(e)))}blockAccountByUser(t){return this.authHttp.post(e.BASE_USER_BLOCKLIST_URL+"/accounts",{accountName:t.nameWithHost}).pipe(Object(o.a)(e=>this.restExtractor.handleError(e)))}unblockAccountByUser(t){return this.authHttp.delete(e.BASE_USER_BLOCKLIST_URL+"/accounts/"+t.nameWithHost).pipe(Object(o.a)(e=>this.restExtractor.handleError(e)))}getUserServerBlocklist(t){const{pagination:r,sort:a,search:c}=t;let s=new i.f;return s=this.restService.addRestGetParams(s,r,a),c&&(s=s.append("search",c)),this.authHttp.get(e.BASE_USER_BLOCKLIST_URL+"/servers",{params:s}).pipe(Object(n.a)(e=>this.restExtractor.convertResultListDateToHuman(e)),Object(o.a)(e=>this.restExtractor.handleError(e)))}blockServerByUser(t){return this.authHttp.post(e.BASE_USER_BLOCKLIST_URL+"/servers",{host:t}).pipe(Object(o.a)(e=>this.restExtractor.handleError(e)))}unblockServerByUser(t){return this.authHttp.delete(e.BASE_USER_BLOCKLIST_URL+"/servers/"+t).pipe(Object(o.a)(e=>this.restExtractor.handleError(e)))}getInstanceAccountBlocklist(t){const{pagination:r,sort:a,search:c}=t;let s=new i.f;return s=this.restService.addRestGetParams(s,r,a),c&&(s=s.append("search",c)),this.authHttp.get(e.BASE_SERVER_BLOCKLIST_URL+"/accounts",{params:s}).pipe(Object(n.a)(e=>this.restExtractor.convertResultListDateToHuman(e)),Object(n.a)(e=>this.restExtractor.applyToResultListData(e,this.formatAccountBlock.bind(this))),Object(o.a)(e=>this.restExtractor.handleError(e)))}blockAccountByInstance(t){return this.authHttp.post(e.BASE_SERVER_BLOCKLIST_URL+"/accounts",{accountName:t.nameWithHost}).pipe(Object(o.a)(e=>this.restExtractor.handleError(e)))}unblockAccountByInstance(t){return this.authHttp.delete(e.BASE_SERVER_BLOCKLIST_URL+"/accounts/"+t.nameWithHost).pipe(Object(o.a)(e=>this.restExtractor.handleError(e)))}getInstanceServerBlocklist(t){const{pagination:r,sort:a,search:c}=t;let s=new i.f;return s=this.restService.addRestGetParams(s,r,a),c&&(s=s.append("search",c)),this.authHttp.get(e.BASE_SERVER_BLOCKLIST_URL+"/servers",{params:s}).pipe(Object(n.a)(e=>this.restExtractor.convertResultListDateToHuman(e)),Object(o.a)(e=>this.restExtractor.handleError(e)))}blockServerByInstance(t){return this.authHttp.post(e.BASE_SERVER_BLOCKLIST_URL+"/servers",{host:t}).pipe(Object(o.a)(e=>this.restExtractor.handleError(e)))}unblockServerByInstance(t){return this.authHttp.delete(e.BASE_SERVER_BLOCKLIST_URL+"/servers/"+t).pipe(Object(o.a)(e=>this.restExtractor.handleError(e)))}formatAccountBlock(e){return new s.a(e)}}return e.BASE_USER_BLOCKLIST_URL=c.a.apiUrl+"/api/v1/users/me/blocklist",e.BASE_SERVER_BLOCKLIST_URL=c.a.apiUrl+"/api/v1/server/blocklist",e.\u0275fac=function(t){return new(t||e)(l.hc(i.b),l.hc(a.r),l.hc(a.s))},e.\u0275prov=l.Mb({token:e,factory:e.\u0275fac}),e})()},HIM4:function(e,t,r){"use strict";r.d(t,"a",function(){return n.a}),r.d(t,"e",function(){return s}),r.d(t,"b",function(){return a.a}),r.d(t,"c",function(){return a.b}),r.d(t,"d",function(){return l.a}),r.d(t,"f",function(){return d}),r.d(t,"h",function(){return b.a}),r.d(t,"g",function(){return v}),r("9BXX"),r("re7S"),r("BYvb");var n=r("9dYW"),o=(r("xHIW"),r("ey9i")),i=r("xMQD"),a=r("GxWh"),c=r("fXoL");let s=(()=>{class e extends o.t{constructor(e,t){super(),this.notifier=e,this.blocklistService=t,this.blockedAccounts=[],this.totalRecords=0,this.sort={field:"createdAt",order:-1},this.pagination={count:this.rowsPerPage,start:0}}ngOnInit(){this.initialize()}switchToDefaultAvatar(e){e.target.src=i.a.GET_DEFAULT_AVATAR_URL()}unblockAccount(e){const t=e.blockedAccount;(this.mode===a.a.Account?this.blocklistService.unblockAccountByUser(t):this.blocklistService.unblockAccountByInstance(t)).subscribe(()=>{this.notifier.success(this.mode===a.a.Account?"\u5E33\u865F " + t.nameWithHost + " \u5DF2\u89E3\u9664\u975C\u97F3\u3002":"\u5E33\u865F " + t.nameWithHost + " \u5DF2\u88AB\u60A8\u7684\u7AD9\u81FA\u89E3\u9664\u975C\u97F3\u3002"),this.loadData()})}loadData(){return(this.mode===a.a.Account?this.blocklistService.getUserAccountBlocklist({pagination:this.pagination,sort:this.sort,search:this.search}):this.blocklistService.getInstanceAccountBlocklist({pagination:this.pagination,sort:this.sort,search:this.search})).subscribe(e=>{this.blockedAccounts=e.data,this.totalRecords=e.total},e=>this.notifier.error(e.message))}}return e.\u0275fac=function(t){return new(t||e)(c.Qb(o.m),c.Qb(a.b))},e.\u0275dir=c.Lb({type:e,features:[c.Ab]}),e})();r("E/r9");var l=r("QLwe");const u=["batchDomainsModal"];let d=(()=>{class e extends o.t{constructor(e,t){super(),this.notifier=e,this.blocklistService=t,this.blockedServers=[],this.totalRecords=0,this.sort={field:"createdAt",order:-1},this.pagination={count:this.rowsPerPage,start:0}}ngOnInit(){this.initialize()}unblockServer(e){const t=e.blockedServer.host;(e=>this.mode===a.a.Account?this.blocklistService.unblockServerByUser(e):this.blocklistService.unblockServerByInstance(e))(t).subscribe(()=>{this.notifier.success(this.mode===a.a.Account?"\u7AD9\u81FA " + t + " \u5DF2\u89E3\u9664\u975C\u97F3\u3002":"\u7AD9\u81FA " + t + " \u5DF2\u88AB\u60A8\u7684\u7AD9\u81FA\u89E3\u9664\u975C\u97F3\u3002"),this.loadData()})}addServersToBlock(){this.batchDomainsModal.openModal()}onDomainsToBlock(e){const t=e=>this.mode===a.a.Account?this.blocklistService.blockServerByUser(e):this.blocklistService.blockServerByInstance(e);e.forEach(e=>{t(e).subscribe(()=>{this.notifier.success(this.mode===a.a.Account?"\u7AD9\u81FA " + e + " \u5DF2\u975C\u97F3\u3002":"\u7AD9\u81FA " + e + " \u5DF2\u88AB\u60A8\u7684\u7AD9\u81FA\u975C\u97F3\u3002"),this.loadData()})})}loadData(){return(this.mode===a.a.Account?this.blocklistService.getUserServerBlocklist({pagination:this.pagination,sort:this.sort,search:this.search}):this.blocklistService.getInstanceServerBlocklist({pagination:this.pagination,sort:this.sort,search:this.search})).subscribe(e=>{this.blockedServers=e.data,this.totalRecords=e.total},e=>this.notifier.error(e.message))}}return e.\u0275fac=function(t){return new(t||e)(c.Qb(o.m),c.Qb(a.b))},e.\u0275dir=c.Lb({type:e,viewQuery:function(e,t){if(1&e&&c.Xc(u,1),2&e){let e;c.Hc(e=c.lc())&&(t.batchDomainsModal=e.first)}},features:[c.Ab]}),e})();r("Imgh"),r("2L7+"),r("XZU/");var b=r("d8Kw"),h=r("N/VM"),f=r("P8w3"),m=r("Nmku"),p=r("ix8N");let v=(()=>{class e{}return e.\u0275mod=c.Ob({type:e}),e.\u0275inj=c.Nb({factory:function(t){return new(t||e)},providers:[a.b,l.a,n.a,b.a],imports:[[m.a,h.a,f.a,p.a]]}),e})()},Imgh:function(e,t,r){"use strict";r.d(t,"a",function(){return p});var n=r("mrSG"),o=r("fXoL"),i=r("ey9i"),a=r("sWvm"),c=r("nnN+"),s=r("1kSV"),l=r("UkmY"),u=r("3Pt+"),d=r("ofXK");const b=["modal"];function h(e,t){if(1&e&&(o.Wb(0,"div",14),o.Tc(1),o.Vb()),2&e){const e=o.oc(2);o.Db(1),o.Vc(" ",e.formErrors.reason," ")}}const f=function(e){return{"input-error":e}};function m(e,t){if(1&e){const e=o.Xb();o.Wb(0,"div",1),o.Wb(1,"h4",2),o.ac(2,3),o.Vb(),o.Wb(3,"my-global-icon",4),o.kc("click",function(){return o.Kc(e),o.oc().hide()}),o.Vb(),o.Vb(),o.Wb(4,"div",5),o.Wb(5,"form",6),o.kc("ngSubmit",function(){return o.Kc(e),o.oc().banUser()}),o.Wb(6,"div",7),o.Rb(7,"textarea",8),o.Rc(8,h,2,1,"div",9),o.Vb(),o.Wb(9,"div"),o.ac(10,10),o.Vb(),o.Wb(11,"div",11),o.Wb(12,"input",12),o.kc("click",function(){return o.Kc(e),o.oc().hide()})("key.enter",function(){return o.Kc(e),o.oc().hide()}),o.Vb(),o.Rb(13,"input",13),o.Vb(),o.Vb(),o.Vb()}if(2&e){const e=o.oc();o.Db(5),o.vc("formGroup",e.form),o.Db(2),o.vc("ngClass",o.zc(4,f,e.formErrors.reason)),o.Db(1),o.vc("ngIf",e.formErrors.reason),o.Db(5),o.vc("disabled",!e.form.valid)}}let p=(()=>{class e extends a.a{constructor(e,t,r,n){super(),this.formValidatorService=e,this.modalService=t,this.notifier=r,this.userService=n,this.userBanned=new o.n}ngOnInit(){this.buildForm({reason:c.a})}openModal(e){this.usersToBan=e,this.openedModal=this.modalService.open(this.modal,{centered:!0})}hide(){this.usersToBan=void 0,this.openedModal.close()}banUser(){return Object(n.a)(this,void 0,void 0,function*(){this.userService.banUsers(this.usersToBan,this.form.value.reason||void 0).subscribe(()=>{const e=Array.isArray(this.usersToBan)?"\n          " + this.usersToBan.length + " \u500B\u4F7F\u7528\u8005\u5DF2\u89E3\u9664\u963B\u64CB\u3002\n        ":"\u4F7F\u7528\u8005 " + this.usersToBan.username + " \u5DF2\u963B\u64CB\u3002";this.notifier.success(e),this.userBanned.emit(this.usersToBan),this.hide()},e=>this.notifier.error(e.message))})}}return e.\u0275fac=function(t){return new(t||e)(o.Qb(a.b),o.Qb(s.o),o.Qb(i.m),o.Qb(i.D))},e.\u0275cmp=o.Kb({type:e,selectors:[["my-user-ban-modal"]],viewQuery:function(e,t){if(1&e&&o.Xc(b,3),2&e){let e;o.Hc(e=o.lc())&&(t.modal=e.first)}},outputs:{userBanned:"userBanned"},features:[o.Ab],decls:2,vars:0,consts:function(){let e,t,r,n,o;return e="\u5C01\u9396",t="\u7406\u7531\u2026\u2026",r="\n        \u88AB\u963B\u64CB\u7684\u4F7F\u7528\u8005\u5C07\u4E0D\u518D\u80FD\u767B\u5165\u3002\n      ",n="\u53D6\u6D88",o="\u963B\u64CB\u6B64\u4F7F\u7528\u8005",[["modal",""],[1,"modal-header"],[1,"modal-title"],e,["iconName","cross","aria-label","Close","role","button",3,"click"],[1,"modal-body"],["novalidate","",3,"formGroup","ngSubmit"],[1,"form-group"],["placeholder",t,"formControlName","reason",1,"form-control",3,"ngClass"],["class","form-error",4,"ngIf"],r,[1,"form-group","inputs"],["type","button","role","button","value",n,1,"action-button","action-button-cancel",3,"click","key.enter"],["type","submit","value",o,1,"action-button-submit",3,"disabled"],[1,"form-error"]]},template:function(e,t){1&e&&o.Rc(0,m,14,6,"ng-template",null,0,o.Sc)},directives:[l.a,u.y,u.n,u.h,u.b,u.m,u.f,d.l,d.n],styles:["textarea[_ngcontent-%COMP%]{display:inline-block;height:30px;width:100%;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid #c6c6c6;border-radius:3px;color:var(--textareaForegroundColor);background-color:var(--textareaBackgroundColor);height:60px;padding:5px 15px;font-size:15px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}textarea[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width:100%){textarea[_ngcontent-%COMP%]{width:100%}}"]}),e})()},L3Qv:function(e,t,r){"use strict";t.a=function(){return!1}},QLwe:function(e,t,r){"use strict";r.d(t,"a",function(){return s});var n=r("JIr8"),o=r("ey9i"),i=r("AytR"),a=r("fXoL"),c=r("tk/3");let s=(()=>{class e{constructor(e,t){this.authHttp=e,this.restExtractor=t}removeCommentsOf(t){return this.authHttp.post(e.BASE_BULK_URL+"/remove-comments-of",t).pipe(Object(n.a)(e=>this.restExtractor.handleError(e)))}}return e.BASE_BULK_URL=i.a.apiUrl+"/api/v1/bulk",e.\u0275fac=function(t){return new(t||e)(a.hc(c.b),a.hc(o.r))},e.\u0275prov=a.Mb({token:e,factory:e.\u0275fac}),e})()},TFwu:function(e,t,r){"use strict";var n=r("25cm"),o=r("jN84"),i=r("mkut");t.a=function(e){return Object(n.a)(e,i.a,o.a)}},TSHB:function(e,t,r){"use strict";var n=r("uE2L"),o=r("mkut"),i=r("fywt");t.a=function(e,t){var r={};return t=Object(i.a)(t,3),function(e,t){e&&function(e,t,r){for(var n=-1,o=Object(e),i=r(e),a=i.length;a--;){var c=i[++n];if(!1===t(o[c],c,o))break}}(e,t,o.a)}(e,function(e,o,i){Object(n.a)(r,o,t(e,o,i))}),r}},TnHx:function(e,t,r){"use strict";var n=r("25cm"),o=r("n561"),i=r("4/q3");t.a=function(e){return Object(n.a)(e,i.a,o.a)}},U6JX:function(e,t,r){"use strict";t.a=function(e,t){return function(r){return e(t(r))}}},UudT:function(e,t,r){"use strict";var n=r("U6JX"),o=Object(n.a)(Object.getPrototypeOf,Object);t.a=o},WJ6P:function(e,t,r){"use strict";t.a=function(){return[]}},WOAq:function(e,t,r){"use strict";(function(e){var n=r("Ju5/"),o=r("L3Qv"),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,c=a&&a.exports===i?n.a.Buffer:void 0;t.a=(c?c.isBuffer:void 0)||o.a}).call(this,r("3UD+")(e))},"XZU/":function(e,t,r){"use strict";r.d(t,"a",function(){return O});var n=r("fXoL"),o=r("ey9i"),i=r("sWvm"),a=(r("xMQD"),r("3Pt+"));const c={VALIDATORS:[a.w.minLength(2),a.w.maxLength(300)],MESSAGES:{minlength:"\u5C01\u9396\u7406\u7531\u5FC5\u9808\u81F3\u5C11 2 \u500B\u5B57\u5143\u9577\u3002",maxlength:"\u5C01\u9396\u7406\u7531\u4E0D\u80FD\u591A\u65BC 300 \u500B\u5B57\u5143\u9577\u3002"}};var s=r("d8Kw"),l=r("1kSV"),u=r("ofXK"),d=r("UkmY"),b=r("/xt7");const h=["modal"];function f(e,t){if(1&e&&(n.Wb(0,"h4",14),n.ac(1,15),n.Vb()),2&e){const e=n.oc(2);n.Db(1),n.ec(e.video.name),n.bc(1)}}function m(e,t){if(1&e&&(n.Wb(0,"h4",14),n.ac(1,16),n.Vb()),2&e){const e=n.oc(2);n.Db(1),n.ec(e.video.name),n.bc(1)}}function p(e,t){if(1&e&&(n.Wb(0,"div",17),n.Tc(1),n.Vb()),2&e){const e=n.oc(2);n.Db(1),n.Vc(" ",e.formErrors.reason," ")}}function v(e,t){1&e&&(n.Wb(0,"div",6),n.Wb(1,"my-peertube-checkbox",18),n.Ub(2,19),n.Wb(3,"span"),n.ac(4,20),n.Vb(),n.Tb(),n.Vb(),n.Vb())}function g(e,t){1&e&&(n.Wb(0,"strong",21),n.ac(1,22),n.Vb())}const y=function(e){return{"input-error":e}};function S(e,t){if(1&e){const e=n.Xb();n.Wb(0,"div",1),n.Rc(1,f,2,1,"h4",2),n.Rc(2,m,2,1,"h4",2),n.Wb(3,"my-global-icon",3),n.kc("click",function(){return n.Kc(e),n.oc().hide()}),n.Vb(),n.Vb(),n.Wb(4,"div",4),n.Wb(5,"form",5),n.kc("ngSubmit",function(){return n.Kc(e),n.oc().block()}),n.Wb(6,"div",6),n.Rb(7,"textarea",7),n.Rc(8,p,2,1,"div",8),n.Vb(),n.Rc(9,v,5,0,"div",9),n.Rc(10,g,2,0,"strong",10),n.Wb(11,"div",11),n.Wb(12,"input",12),n.kc("click",function(){return n.Kc(e),n.oc().hide()})("key.enter",function(){return n.Kc(e),n.oc().hide()}),n.Vb(),n.Rb(13,"input",13),n.Vb(),n.Vb(),n.Vb()}if(2&e){const e=n.oc();n.Db(1),n.vc("ngIf",!e.video.isLive),n.Db(1),n.vc("ngIf",e.video.isLive),n.Db(3),n.vc("formGroup",e.form),n.Db(2),n.vc("ngClass",n.zc(8,y,e.formErrors.reason)),n.Db(1),n.vc("ngIf",e.formErrors.reason),n.Db(1),n.vc("ngIf",e.video.isLocal),n.Db(1),n.vc("ngIf",e.video.isLive),n.Db(3),n.vc("disabled",!e.form.valid)}}let O=(()=>{class e extends i.a{constructor(e,t,r,o){super(),this.formValidatorService=e,this.modalService=t,this.videoBlocklistService=r,this.notifier=o,this.video=null,this.videoBlocked=new n.n,this.error=null}ngOnInit(){this.buildForm({reason:c,unfederate:null},{unfederate:"true"})}show(){this.openedModal=this.modalService.open(this.modal,{centered:!0,keyboard:!1})}hide(){this.openedModal.close(),this.openedModal=null}block(){const e=this.form.value.reason||void 0;this.videoBlocklistService.blockVideo(this.video.id,e,this.video.isLocal?this.form.value.unfederate:void 0).subscribe(()=>{this.notifier.success("\u5F71\u7247\u5DF2\u5C01\u9396\u3002"),this.hide(),this.video.blacklisted=!0,this.video.blockedReason=e,this.videoBlocked.emit()},e=>this.notifier.error(e.message))}}return e.\u0275fac=function(t){return new(t||e)(n.Qb(i.b),n.Qb(l.o),n.Qb(s.a),n.Qb(o.m))},e.\u0275cmp=n.Kb({type:e,selectors:[["my-video-block"]],viewQuery:function(e,t){if(1&e&&n.Xc(h,3),2&e){let e;n.Hc(e=n.lc())&&(t.modal=e.first)}},inputs:{video:"video"},outputs:{videoBlocked:"videoBlocked"},features:[n.Ab],decls:2,vars:0,consts:function(){let e,t,r,n,o,i,a,c;return e="\u8ACB\u63CF\u8FF0\u7406\u7531\u2026\u2026",t="\u53D6\u6D88",r="\u905E\u4EA4",n="\u5C01\u9396\u5F71\u7247 \"" + "\ufffd0\ufffd" + "\"",o="\u5C01\u9396\u76F4\u64AD \"" + "\ufffd0\ufffd" + "\"",i="\u89E3\u9664\u5F71\u7247\u806F\u64AD",a="\u9019\u6703\u8981\u6C42\u9060\u7AEF\u7AD9\u81FA\u5C07\u5176\u522A\u9664",c="\u5C01\u9396\u6B64\u76F4\u64AD\u5C07\u6703\u81EA\u52D5\u7D50\u675F\u76F4\u64AD\u4E32\u6D41\u3002",[["modal",""],[1,"modal-header"],["class","modal-title",4,"ngIf"],["iconName","cross","aria-label","Close","role","button",3,"click"],[1,"modal-body"],["novalidate","",3,"formGroup","ngSubmit"],[1,"form-group"],["placeholder",e,"formControlName","reason",1,"form-control",3,"ngClass"],["class","form-error",4,"ngIf"],["class","form-group",4,"ngIf"],["class","live-info",4,"ngIf"],[1,"form-group","inputs"],["type","button","role","button","value",t,1,"action-button","action-button-cancel",3,"click","key.enter"],["type","submit","value",r,1,"action-button-submit",3,"disabled"],[1,"modal-title"],n,o,[1,"form-error"],["inputName","unfederate","formControlName","unfederate","labelText",i],["ngProjectAs","description",5,["description"]],a,[1,"live-info"],c]},template:function(e,t){1&e&&n.Rc(0,S,14,10,"ng-template",null,0,n.Sc)},directives:[u.n,d.a,a.y,a.n,a.h,a.b,a.m,a.f,u.l,b.a],styles:["textarea[_ngcontent-%COMP%]{display:inline-block;height:30px;width:100%;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid #c6c6c6;border-radius:3px;color:var(--textareaForegroundColor);background-color:var(--textareaBackgroundColor);height:100px;padding:5px 15px;font-size:15px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}textarea[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width:100%){textarea[_ngcontent-%COMP%]{width:100%}}.live-info[_ngcontent-%COMP%]{font-size:15px;margin:40px 0 20px}"]}),e})()},YM6B:function(e,t,r){"use strict";var n=r("Y7yP"),o=r("Ju5/"),i=Object(n.a)(o.a,"DataView"),a=r("3cmB"),c=Object(n.a)(o.a,"Promise"),s=r("pVw1"),l=Object(n.a)(o.a,"WeakMap"),u=r("8M4i"),d=r("dLWn"),b="[object Map]",h="[object Promise]",f="[object Set]",m="[object WeakMap]",p="[object DataView]",v=Object(d.a)(i),g=Object(d.a)(a.a),y=Object(d.a)(c),S=Object(d.a)(s.a),O=Object(d.a)(l),A=u.a;(i&&A(new i(new ArrayBuffer(1)))!=p||a.a&&A(new a.a)!=b||c&&A(c.resolve())!=h||s.a&&A(new s.a)!=f||l&&A(new l)!=m)&&(A=function(e){var t=Object(u.a)(e),r="[object Object]"==t?e.constructor:void 0,n=r?Object(d.a)(r):"";if(n)switch(n){case v:return p;case g:return b;case y:return h;case S:return f;case O:return m}return t}),t.a=A},ZWiB:function(e,t,r){"use strict";t.a=function(e,t){return e.has(t)}},d8Kw:function(e,t,r){"use strict";r.d(t,"a",function(){return b});var n=r("Cfvw"),o=r("lJxs"),i=r("JIr8"),a=r("bOdf"),c=r("IAdc"),s=r("tk/3"),l=r("ey9i"),u=r("AytR"),d=r("fXoL");let b=(()=>{class e{constructor(e,t,r){this.authHttp=e,this.restService=t,this.restExtractor=r}listBlocks(t){const{pagination:r,sort:n,search:a,type:c}=t;let l=new s.f;if(l=this.restService.addRestGetParams(l,r,n),a){const e=this.restService.parseQueryStringFilter(a,{type:{prefix:"type:",handler:e=>"manual"===e?1:"auto"===e?2:void 0}});l=this.restService.addObjectParams(l,e)}return c&&(l=l.append("type",c.toString())),this.authHttp.get(e.BASE_VIDEOS_URL+"blacklist",{params:l}).pipe(Object(o.a)(e=>this.restExtractor.convertResultListDateToHuman(e)),Object(i.a)(e=>this.restExtractor.handleError(e)))}unblockVideo(t){const r=Array.isArray(t)?t:[t];return Object(n.a)(r).pipe(Object(a.a)(t=>this.authHttp.delete(e.BASE_VIDEOS_URL+t+"/blacklist")),Object(c.a)(),Object(i.a)(e=>this.restExtractor.handleError(e)))}blockVideo(t,r,n){return this.authHttp.post(e.BASE_VIDEOS_URL+t+"/blacklist",{unfederate:n,reason:r}).pipe(Object(o.a)(this.restExtractor.extractDataBool),Object(i.a)(e=>this.restExtractor.handleError(e)))}}return e.BASE_VIDEOS_URL=u.a.apiUrl+"/api/v1/videos/",e.\u0275fac=function(t){return new(t||e)(d.hc(s.b),d.hc(l.s),d.hc(l.r))},e.\u0275prov=d.Mb({token:e,factory:e.\u0275fac}),e})()},fywt:function(e,t,r){"use strict";var n=r("oSzE"),o=r("msdH"),i=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1},a=r("ZWiB"),c=function(e,t,r,n,c,s){var l=1&r,u=e.length,d=t.length;if(u!=d&&!(l&&d>u))return!1;var b=s.get(e),h=s.get(t);if(b&&h)return b==t&&h==e;var f=-1,m=!0,p=2&r?new o.a:void 0;for(s.set(e,t),s.set(t,e);++f<u;){var v=e[f],g=t[f];if(n)var y=l?n(g,v,f,t,e,s):n(v,g,f,e,t,s);if(void 0!==y){if(y)continue;m=!1;break}if(p){if(!i(t,function(e,t){if(!Object(a.a)(p,t)&&(v===e||c(v,e,r,n,s)))return p.push(t)})){m=!1;break}}else if(v!==g&&!c(v,g,r,n,s)){m=!1;break}}return s.delete(e),s.delete(t),m},s=r("ylTp"),l=r("Ce4a"),u=r("YHEm"),d=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r},b=r("GYlH"),h=s.a?s.a.prototype:void 0,f=h?h.valueOf:void 0,m=r("TFwu"),p=Object.prototype.hasOwnProperty,v=r("YM6B"),g=r("/1FC"),y=r("WOAq"),S=r("oYcn"),O="[object Arguments]",A="[object Array]",j="[object Object]",E=Object.prototype.hasOwnProperty,x=r("EUcb"),R=function e(t,r,o,i,a){return t===r||(null==t||null==r||!Object(x.a)(t)&&!Object(x.a)(r)?t!=t&&r!=r:function(e,t,r,o,i,a){var s=Object(g.a)(e),h=Object(g.a)(t),x=s?A:Object(v.a)(e),R=h?A:Object(v.a)(t),k=(x=x==O?j:x)==j,w=(R=R==O?j:R)==j,_=x==R;if(_&&Object(y.a)(e)){if(!Object(y.a)(t))return!1;s=!0,k=!1}if(_&&!k)return a||(a=new n.a),s||Object(S.a)(e)?c(e,t,r,o,i,a):function(e,t,r,n,o,i,a){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!i(new l.a(e),new l.a(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Object(u.a)(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=d;case"[object Set]":if(s||(s=b.a),e.size!=t.size&&!(1&n))return!1;var h=a.get(e);if(h)return h==t;n|=2,a.set(e,t);var m=c(s(e),s(t),n,o,i,a);return a.delete(e),m;case"[object Symbol]":if(f)return f.call(e)==f.call(t)}return!1}(e,t,x,r,o,i,a);if(!(1&r)){var C=k&&E.call(e,"__wrapped__"),B=w&&E.call(t,"__wrapped__");if(C||B){var I=C?e.value():e,z=B?t.value():t;return a||(a=new n.a),i(I,z,r,o,a)}}return!!_&&(a||(a=new n.a),function(e,t,r,n,o,i){var a=1&r,c=Object(m.a)(e),s=c.length;if(s!=Object(m.a)(t).length&&!a)return!1;for(var l=s;l--;){var u=c[l];if(!(a?u in t:p.call(t,u)))return!1}var d=i.get(e),b=i.get(t);if(d&&b)return d==t&&b==e;var h=!0;i.set(e,t),i.set(t,e);for(var f=a;++l<s;){var v=e[u=c[l]],g=t[u];if(n)var y=a?n(g,v,u,t,e,i):n(v,g,u,e,t,i);if(!(void 0===y?v===g||o(v,g,r,n,i):y)){h=!1;break}f||(f="constructor"==u)}if(h&&!f){var S=e.constructor,O=t.constructor;S==O||!("constructor"in e)||!("constructor"in t)||"function"==typeof S&&S instanceof S&&"function"==typeof O&&O instanceof O||(h=!1)}return i.delete(e),i.delete(t),h}(e,t,r,o,i,a))}(t,r,o,i,e,a))},k=r("IzLi"),w=function(e){return e==e&&!Object(k.a)(e)},_=r("mkut"),C=function(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}},B=r("UTJH"),I=r("K160"),z=r("vY+C"),$=r("Tchk"),L=r("+Xah"),V=r("FSIP");t.a=function(e){return"function"==typeof e?e:null==e?L.a:"object"==typeof e?Object(g.a)(e)?(o=e[0],i=e[1],Object(z.a)(o)&&w(i)?C(Object($.a)(o),i):function(e){var t=function(e,t,r){var n=null==e?void 0:Object(B.a)(e,t);return void 0===n?void 0:n}(e,o);return void 0===t&&t===i?Object(I.a)(e,o):R(i,t,3)}):1==(r=function(e){for(var t=Object(_.a)(e),r=t.length;r--;){var n=t[r],o=e[n];t[r]=[n,o,w(o)]}return t}(t=e)).length&&r[0][2]?C(r[0][0],r[0][1]):function(e){return e===t||function(e,t,r,o){var i=r.length,a=i;if(null==e)return!a;for(e=Object(e);i--;){var c=r[i];if(c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++i<a;){var s=(c=r[i])[0],l=e[s],u=c[1];if(c[2]){if(void 0===l&&!(s in e))return!1}else{var d,b=new n.a;if(!(void 0===d?R(u,l,3,o,b):d))return!1}}return!0}(e,0,r)}:function(e){return Object(z.a)(e)?Object(V.a)(Object($.a)(e)):function(e){return function(t){return Object(B.a)(t,e)}}(e)}(e);var t,r,o,i}},ix8N:function(e,t,r){"use strict";r.d(t,"d",function(){return n.a}),r.d(t,"b",function(){return o.a}),r.d(t,"c",function(){return o.b}),r.d(t,"a",function(){return c});var n=r("GeT4"),o=r("8i4Y"),i=r("Nmku"),a=r("fXoL");let c=(()=>{class e{}return e.\u0275mod=a.Ob({type:e}),e.\u0275inj=a.Nb({factory:function(t){return new(t||e)},providers:[n.a],imports:[[i.a]]}),e})()},jN84:function(e,t,r){"use strict";var n=r("WJ6P"),o=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols;t.a=i?function(e){return null==e?[]:(e=Object(e),function(t,r){for(var n=-1,i=null==t?0:t.length,a=0,c=[];++n<i;){var s=t[n];o.call(e,s)&&(c[a++]=s)}return c}(i(e)))}:n.a},m8R6:function(e,t,r){"use strict";var n=r("twO/"),o=r("oSzE"),i=r("23KU"),a=r("uE2L"),c=function(e,t,r,n){var o=!r;r||(r={});for(var c=-1,s=t.length;++c<s;){var l=t[c],u=n?n(r[l],e[l],l,r,e):void 0;void 0===u&&(u=e[l]),o?Object(a.a)(r,l,u):Object(i.a)(r,l,u)}return r},s=r("mkut"),l=r("4/q3"),u=r("3/ER"),d=r("jN84"),b=r("n561"),h=r("TFwu"),f=r("TnHx"),m=r("YM6B"),p=Object.prototype.hasOwnProperty,v=r("Ce4a"),g=function(e){var t=new e.constructor(e.byteLength);return new v.a(t).set(new v.a(e)),t},y=/\w*$/,S=r("ylTp"),O=S.a?S.a.prototype:void 0,A=O?O.valueOf:void 0,j=r("IzLi"),E=Object.create,x=function(){function e(){}return function(t){if(!Object(j.a)(t))return{};if(E)return E(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),R=r("UudT"),k=r("pyRK"),w=r("/1FC"),_=r("WOAq"),C=r("EUcb"),B=r("ovuK"),I=r("xutz"),z=I.a&&I.a.isMap,$=z?Object(B.a)(z):function(e){return Object(C.a)(e)&&"[object Map]"==Object(m.a)(e)},L=I.a&&I.a.isSet,V=L?Object(B.a)(L):function(e){return Object(C.a)(e)&&"[object Set]"==Object(m.a)(e)},D="[object Arguments]",T="[object Function]",U="[object Object]",M={};M[D]=M["[object Array]"]=M["[object ArrayBuffer]"]=M["[object DataView]"]=M["[object Boolean]"]=M["[object Date]"]=M["[object Float32Array]"]=M["[object Float64Array]"]=M["[object Int8Array]"]=M["[object Int16Array]"]=M["[object Int32Array]"]=M["[object Map]"]=M["[object Number]"]=M[U]=M["[object RegExp]"]=M["[object Set]"]=M["[object String]"]=M["[object Symbol]"]=M["[object Uint8Array]"]=M["[object Uint8ClampedArray]"]=M["[object Uint16Array]"]=M["[object Uint32Array]"]=!0,M["[object Error]"]=M[T]=M["[object WeakMap]"]=!1;var P=function e(t,r,n,a,v,S){var O,E=1&r,C=2&r,B=4&r;if(n&&(O=v?n(t,a,v,S):n(t)),void 0!==O)return O;if(!Object(j.a)(t))return t;var I=Object(w.a)(t);if(I){if(O=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&p.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(t),!E)return function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}(t,O)}else{var z=Object(m.a)(t),L=z==T||"[object GeneratorFunction]"==z;if(Object(_.a)(t))return Object(u.a)(t,E);if(z==U||z==D||L&&!v){if(O=C||L?{}:function(e){return"function"!=typeof e.constructor||Object(k.a)(e)?{}:x(Object(R.a)(e))}(t),!E)return C?function(e,t){return c(e,Object(b.a)(e),t)}(t,function(e,t){return e&&c(t,Object(l.a)(t),e)}(O,t)):function(e,t){return c(e,Object(d.a)(e),t)}(t,function(e,t){return e&&c(t,Object(s.a)(t),e)}(O,t))}else{if(!M[z])return v?t:{};O=function(e,t,r){var n,o,i=e.constructor;switch(t){case"[object ArrayBuffer]":return g(e);case"[object Boolean]":case"[object Date]":return new i(+e);case"[object DataView]":return function(e,t){var r=t?g(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(e,t){var r=t?g(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}(e,r);case"[object Map]":return new i;case"[object Number]":case"[object String]":return new i(e);case"[object RegExp]":return(o=new(n=e).constructor(n.source,y.exec(n))).lastIndex=n.lastIndex,o;case"[object Set]":return new i;case"[object Symbol]":return A?Object(A.call(e)):{}}}(t,z,E)}}S||(S=new o.a);var P=S.get(t);if(P)return P;S.set(t,O),V(t)?t.forEach(function(o){O.add(e(o,r,n,o,t,S))}):$(t)&&t.forEach(function(o,i){O.set(i,e(o,r,n,i,t,S))});var W=I?void 0:(B?C?f.a:h.a:C?l.a:s.a)(t);return function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r););}(W||t,function(o,a){W&&(o=t[a=o]),Object(i.a)(O,a,e(o,r,n,a,t,S))}),O},W=r("IlA0"),H=r("UTJH"),N=r("5iG2"),G=r("Tchk"),K=function(e,t){return null==(e=function(e,t){return t.length<2?e:Object(H.a)(e,Object(N.a)(t,0,-1))}(e,t=Object(W.a)(t,e)))||delete e[Object(G.a)((r=t,n=null==r?0:r.length,n?r[n-1]:void 0))];var r,n},F=r("8M4i"),q=Function.prototype.toString,Q=Object.prototype.hasOwnProperty,X=q.call(Object),Y=function(e){return function(e){if(!Object(C.a)(e)||"[object Object]"!=Object(F.a)(e))return!1;var t=Object(R.a)(e);if(null===t)return!0;var r=Q.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&q.call(r)==X}(e)?void 0:e},J=r("Tjpy"),Z=Object(J.a)(function(e,t){var r={};if(null==e)return r;var o=!1;t=Object(n.a)(t,function(t){return t=Object(W.a)(t,e),o||(o=t.length>1),t}),c(e,Object(f.a)(e),r),o&&(r=P(r,7,Y));for(var i=t.length;i--;)K(r,t[i]);return r});t.a=Z},mkut:function(e,t,r){"use strict";var n=r("7gMY"),o=r("pyRK"),i=r("U6JX"),a=Object(i.a)(Object.keys,Object),c=Object.prototype.hasOwnProperty,s=r("5WsY");t.a=function(e){return Object(s.a)(e)?Object(n.a)(e):function(e){if(!Object(o.a)(e))return a(e);var t=[];for(var r in Object(e))c.call(e,r)&&"constructor"!=r&&t.push(r);return t}(e)}},msdH:function(e,t,r){"use strict";var n=r("DlmY");function o(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n.a;++t<r;)this.add(e[t])}o.prototype.add=o.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},o.prototype.has=function(e){return this.__data__.has(e)},t.a=o},n561:function(e,t,r){"use strict";var n=r("tPH9"),o=r("UudT"),i=r("jN84"),a=r("WJ6P");t.a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Object(n.a)(t,Object(i.a)(e)),e=Object(o.a)(e);return t}:a.a},"nnN+":function(e,t,r){"use strict";r.d(t,"m",function(){return o}),r.d(t,"b",function(){return i}),r.d(t,"f",function(){return a}),r.d(t,"h",function(){return c}),r.d(t,"g",function(){return s}),r.d(t,"j",function(){return l}),r.d(t,"i",function(){return u}),r.d(t,"c",function(){return d}),r.d(t,"o",function(){return b}),r.d(t,"n",function(){return h}),r.d(t,"k",function(){return f}),r.d(t,"e",function(){return m}),r.d(t,"d",function(){return p}),r.d(t,"l",function(){return v}),r.d(t,"a",function(){return g});var n=r("3Pt+");const o={VALIDATORS:[n.w.required,n.w.minLength(1),n.w.maxLength(50),n.w.pattern(/^[a-z0-9][a-z0-9._]*$/)],MESSAGES:{required:"\u4F7F\u7528\u8005\u540D\u7A31\u5FC5\u586B\u3002",minlength:"\u4F7F\u7528\u8005\u540D\u7A31\u5FC5\u9808\u81F3\u5C11 1 \u500B\u5B57\u5143\u9577\u3002",maxlength:"\u4F7F\u7528\u8005\u540D\u7A31\u4E0D\u80FD\u591A\u65BC 50 \u500B\u5B57\u5143\u3002",pattern:"\u4F7F\u7528\u8005\u540D\u7A31\u61C9\u8A72\u662F\u82F1\u6587\u5C0F\u5BEB\u52A0\u4E0A\u6578\u5B57\uFF1B\u9EDE\u8207\u5E95\u7DDA\u4E5F\u53EF\u4EE5\u3002"}},i={VALIDATORS:[n.w.required,n.w.minLength(1),n.w.maxLength(50),n.w.pattern(/^[a-z0-9][a-z0-9._]*$/)],MESSAGES:{required:"\u983B\u9053\u540D\u7A31\u5FC5\u586B\u3002",minlength:"\u983B\u9053\u540D\u7A31\u5FC5\u9808\u81F3\u5C11 1 \u500B\u5B57\u5143\u9577\u3002",maxlength:"\u983B\u9053\u540D\u7A31\u4E0D\u80FD\u591A\u65BC 50 \u500B\u5B57\u5143\u3002",pattern:"\u983B\u9053\u540D\u7A31\u5FC5\u9808\u662F\u5C0F\u5BEB\uFF0C\u4E14\u53EA\u80FD\u5305\u542B\u5B57\u6BCD\u8207\u6578\u5B57\u5B57\u5143\u3001\u9EDE\u8207\u5E95\u7DDA\u3002"}},a={VALIDATORS:[n.w.required,n.w.email],MESSAGES:{required:"\u96FB\u5B50\u90F5\u4EF6\u5FC5\u586B\u3002",email:"\u96FB\u5B50\u90F5\u4EF6\u5FC5\u9808\u70BA\u6709\u6548\u96FB\u5B50\u90F5\u4EF6\u3002"}},c={VALIDATORS:[n.w.required,n.w.pattern(/@.+/)],MESSAGES:{required:"\u5E33\u865F\u5FC5\u586B\u3002",pattern:"\u5E33\u865F\u5FC5\u9808\u6709\u6548\uFF08\u4F8B\u5982 chocobozzz@example.com\uFF09\u3002"}},s={VALIDATORS:[n.w.required],MESSAGES:{required:"\u5BC6\u78BC\u5FC5\u586B\u3002"}},l={VALIDATORS:[n.w.required,n.w.minLength(6),n.w.maxLength(255)],MESSAGES:{required:"\u5BC6\u78BC\u5FC5\u586B\u3002",minlength:"\u5BC6\u78BC\u5FC5\u9808\u81F3\u5C11 6 \u500B\u5B57\u5143\u9577\u3002",maxlength:"\u5BC6\u78BC\u4E0D\u80FD\u591A\u65BC 255 \u500B\u5B57\u5143\u3002"}},u={VALIDATORS:[n.w.minLength(6),n.w.maxLength(255)],MESSAGES:{minlength:"\u5BC6\u78BC\u5FC5\u9808\u81F3\u5C11 6 \u500B\u5B57\u5143\u9577\u3002",maxlength:"\u5BC6\u78BC\u4E0D\u80FD\u591A\u65BC 255 \u500B\u5B57\u5143\u3002"}},d={VALIDATORS:[],MESSAGES:{matchPassword:"\u65B0\u5BC6\u78BC\u8207\u5BC6\u78BC\u78BA\u8A8D\u4E0D\u76F8\u7B26\u3002"}},b={VALIDATORS:[n.w.required,n.w.min(-1)],MESSAGES:{required:"\u5F71\u7247\u914D\u984D\u5FC5\u586B\u3002",min:"\u914D\u984D\u5FC5\u9808\u5927\u65BC -1\u3002"}},h={VALIDATORS:[n.w.required,n.w.min(-1)],MESSAGES:{required:"\u6BCF\u65E5\u4E0A\u50B3\u9650\u5236\u5FC5\u586B\u3002",min:"\u6BCF\u65E5\u4E0A\u50B3\u9650\u5236\u5FC5\u9808\u5927\u65BC -1\u3002"}},f={VALIDATORS:[n.w.required],MESSAGES:{required:"\u4F7F\u7528\u8005\u89D2\u8272\u5FC5\u586B\u3002"}},m=function(e){const t={VALIDATORS:[n.w.minLength(1),n.w.maxLength(120)],MESSAGES:{required:"\u986F\u793A\u540D\u7A31\u5FC5\u586B\u3002",minlength:"\u986F\u793A\u540D\u7A31\u5FC5\u9808\u81F3\u5C11 1 \u500B\u5B57\u5143\u9577\u3002",maxlength:"\u986F\u793A\u540D\u7A31\u4E0D\u80FD\u591A\u65BC 50 \u500B\u5B57\u5143\u3002"}};return t.VALIDATORS.push(n.w.required),t}(),p={VALIDATORS:[n.w.minLength(3),n.w.maxLength(1e3)],MESSAGES:{minlength:"\u63CF\u8FF0\u5FC5\u9808\u81F3\u5C11 3 \u500B\u5B57\u5143\u9577\u3002",maxlength:"\u63CF\u8FF0\u4E0D\u80FD\u591A\u65BC 1000 \u500B\u5B57\u5143\u3002"}},v={VALIDATORS:[n.w.requiredTrue],MESSAGES:{required:"\u60A8\u5FC5\u9808\u540C\u610F\u7AD9\u81FA\u689D\u6B3E\u4EE5\u5728\u5176\u4E0A\u8A3B\u518A\u3002"}},g={VALIDATORS:[n.w.minLength(3),n.w.maxLength(250)],MESSAGES:{minlength:"\u963B\u64CB\u7406\u7531\u5FC5\u9808\u81F3\u5C11 3 \u500B\u5B57\u5143\u3002",maxlength:"\u963B\u64CB\u7406\u7531\u5FC5\u9808\u591A\u65BC 250 \u500B\u5B57\u5143\u3002"}}},oSzE:function(e,t,r){"use strict";var n=r("nLtN"),o=r("3cmB"),i=r("DlmY");function a(e){var t=this.__data__=new n.a(e);this.size=t.size}a.prototype.clear=function(){this.__data__=new n.a,this.size=0},a.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},a.prototype.get=function(e){return this.__data__.get(e)},a.prototype.has=function(e){return this.__data__.has(e)},a.prototype.set=function(e,t){var r=this.__data__;if(r instanceof n.a){var a=r.__data__;if(!o.a||a.length<199)return a.push([e,t]),this.size=++r.size,this;r=this.__data__=new i.a(a)}return r.set(e,t),this.size=r.size,this},t.a=a},oYcn:function(e,t,r){"use strict";var n=r("8M4i"),o=r("Js68"),i=r("EUcb"),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1;var c=r("ovuK"),s=r("xutz"),l=s.a&&s.a.isTypedArray,u=l?Object(c.a)(l):function(e){return Object(i.a)(e)&&Object(o.a)(e.length)&&!!a[Object(n.a)(e)]};t.a=u},pVw1:function(e,t,r){"use strict";var n=r("Y7yP"),o=r("Ju5/"),i=Object(n.a)(o.a,"Set");t.a=i},pyRK:function(e,t,r){"use strict";var n=Object.prototype;t.a=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},re7S:function(e,t,r){"use strict";r.d(t,"a",function(){return R});var n=r("TSHB"),o=r("u3oV"),i=r("ey9i"),a=r("4joM"),c=r("sWvm"),s=(r("ix8N"),r("3ZlK")),l=r("9dYW"),u=r("fXoL"),d=r("1kSV"),b=r("UkmY"),h=r("3Pt+"),f=r("ofXK"),m=r("/xt7"),p=r("BLxp");const v=["modal"];function g(e,t){if(1&e&&u.Rb(0,"div",26),2&e){const e=u.oc(2).$implicit;u.vc("innerHTML",e.help,u.Lc)}}function y(e,t){1&e&&u.Rc(0,g,1,1,"ng-template",25)}function S(e,t){if(1&e&&(u.Ub(0,27),u.Rb(1,"div",26),u.Tb()),2&e){const e=u.oc().$implicit;u.Db(1),u.vc("innerHTML",e.description,u.Lc)}}function O(e,t){if(1&e&&(u.Wb(0,"div",17),u.Wb(1,"my-peertube-checkbox",23),u.Rc(2,y,1,0,void 0,16),u.Rc(3,S,2,1,"ng-container",24),u.Vb(),u.Vb()),2&e){const e=t.$implicit;u.Db(1),u.vc("inputName",e.id)("formControlName",e.id)("labelText",e.label),u.Db(1),u.vc("ngIf",e.help),u.Db(1),u.vc("ngIf",e.description)}}function A(e,t){if(1&e&&(u.gc(0,15,1),u.Sb(1),u.dc()),2&e){const e=u.oc(2);u.Db(1),u.ec(e.originHost),u.bc(0)}}function j(e,t){if(1&e&&(u.Wb(0,"div",28),u.Tc(1),u.Vb()),2&e){const e=u.oc(2);u.Db(1),u.Vc(" ",e.formErrors.reason," ")}}const E=function(e){return{"input-error":e}};function x(e,t){if(1&e){const e=u.Xb();u.Wb(0,"div",1),u.Wb(1,"h4",2),u.Tc(2),u.Vb(),u.Wb(3,"my-global-icon",3),u.kc("click",function(){return u.Kc(e),u.oc().hide()}),u.Vb(),u.Vb(),u.Wb(4,"div",4),u.Wb(5,"form",5),u.kc("ngSubmit",function(){return u.Kc(e),u.oc().report()}),u.Wb(6,"div",6),u.Wb(7,"div",7),u.Wb(8,"label",8),u.ac(9,9),u.Vb(),u.Wb(10,"div",10),u.Ub(11,11),u.Rc(12,O,4,5,"div",12),u.Tb(),u.Vb(),u.Vb(),u.Wb(13,"div",13),u.Wb(14,"div",14),u.gc(15,15),u.Rc(16,A,2,1,"ng-container",16),u.dc(),u.Vb(),u.Wb(17,"div",17),u.Rb(18,"textarea",18),u.Rc(19,j,2,1,"div",19),u.Vb(),u.Vb(),u.Vb(),u.Wb(20,"div",20),u.Wb(21,"input",21),u.kc("click",function(){return u.Kc(e),u.oc().hide()})("key.enter",function(){return u.Kc(e),u.oc().hide()}),u.Vb(),u.Rb(22,"input",22),u.Vb(),u.Vb(),u.Vb()}if(2&e){const e=u.oc();u.Db(2),u.Uc(e.modalTitle),u.Db(3),u.vc("formGroup",e.form),u.Db(7),u.vc("ngForOf",e.predefinedReasons),u.Db(4),u.vc("ngIf",e.isRemote()),u.ec(e.currentHost),u.bc(15),u.Db(2),u.vc("ngClass",u.zc(8,E,e.formErrors.reason)),u.Db(1),u.vc("ngIf",e.formErrors.reason),u.Db(3),u.vc("disabled",!e.form.valid)}}let R=(()=>{class e extends c.a{constructor(e,t,r,n){super(),this.formValidatorService=e,this.modalService=t,this.abuseService=r,this.notifier=n,this.comment=null,this.error=null,this.predefinedReasons=[]}get currentHost(){return window.location.host}get originHost(){return this.isRemote()?this.comment.account.host:""}ngOnInit(){this.modalTitle="\u56DE\u5831\u7559\u8A00",this.buildForm({reason:a.c,predefinedReasons:Object(n.a)(s.a,e=>null)}),this.predefinedReasons=this.abuseService.getPrefefinedReasons("comment")}show(){this.openedModal=this.modalService.open(this.modal,{centered:!0,keyboard:!1,size:"lg"})}hide(){this.openedModal.close(),this.openedModal=null}report(){const e=this.form.get("reason").value,t=Object.keys(Object(o.a)(this.form.get("predefinedReasons").value));this.abuseService.reportVideo({reason:e,predefinedReasons:t,comment:{id:this.comment.id}}).subscribe(()=>{this.notifier.success("\u7559\u8A00\u5DF2\u56DE\u5831\u3002"),this.hide()},e=>this.notifier.error(e.message))}isRemote(){return!this.comment.isLocal}}return e.\u0275fac=function(t){return new(t||e)(u.Qb(c.b),u.Qb(d.o),u.Qb(l.a),u.Qb(i.m))},e.\u0275cmp=u.Kb({type:e,selectors:[["my-comment-report"]],viewQuery:function(e,t){if(1&e&&u.Xc(v,3),2&e){let e;u.Hc(e=u.lc())&&(t.modal=e.first)}},inputs:{comment:"comment"},features:[u.Ab],decls:2,vars:0,consts:function(){let e,t,r,n,o;return e="\u4EC0\u9EBC\u554F\u984C\uFF1F",t="\u8ACB\u63CF\u8FF0\u554F\u984C\u2026\u2026",r="\u53D6\u6D88",n="\u905E\u4EA4",o="\u60A8\u7684\u56DE\u5831\u5C07\u6703\u50B3\u9001\u7D66 " + "\ufffd0\ufffd" + "" + "\ufffd*16:1\ufffd\ufffd#1:1\ufffd" + " \u7684\u677F\u4E3B\u4E14\u4E5F\u6703\u8F49\u767C\u7D66\u7559\u8A00\u7684\u539F\u59CB\u4F86\u6E90 (" + "\ufffd0:1\ufffd" + ") " + "\ufffd/#1:1\ufffd\ufffd/*16:1\ufffd" + "\u3002 ",[["modal",""],[1,"modal-header"],[1,"modal-title"],["iconName","cross","aria-label","Close","role","button",3,"click"],[1,"modal-body"],["novalidate","",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-5","form-group"],["for","reportPredefinedReasons"],e,[1,"ml-2","mt-2","d-flex","flex-column"],["formGroupName","predefinedReasons"],["class","form-group",4,"ngFor","ngForOf"],[1,"col-7"],[1,"information"],o,[4,"ngIf"],[1,"form-group"],["placeholder",t,"formControlName","reason","ngbAutofocus","",1,"form-control",3,"ngClass"],["class","form-error",4,"ngIf"],[1,"form-group","inputs"],["type","button","role","button","value",r,1,"action-button","action-button-cancel",3,"click","key.enter"],["type","submit","value",n,1,"action-button-submit",3,"disabled"],[3,"inputName","formControlName","labelText"],["ngProjectAs","description",5,["description"],4,"ngIf"],["ptTemplate","help"],[3,"innerHTML"],["ngProjectAs","description",5,["description"]],[1,"form-error"]]},template:function(e,t){1&e&&u.Rc(0,x,23,10,"ng-template",null,0,u.Sc)},directives:[b.a,h.y,h.n,h.h,h.i,f.m,f.n,h.b,h.m,h.f,f.l,m.a,p.a],styles:[".information[_ngcontent-%COMP%]{margin-bottom:20px}textarea[_ngcontent-%COMP%]{display:inline-block;height:30px;width:100%;color:var(--inputForegroundColor);background-color:var(--inputBackgroundColor);border:1px solid #c6c6c6;border-radius:3px;color:var(--textareaForegroundColor);background-color:var(--textareaBackgroundColor);height:100px;padding:5px 15px;font-size:15px}textarea[_ngcontent-%COMP%]::placeholder{color:var(--inputPlaceholderColor)}textarea[readonly][_ngcontent-%COMP%]{opacity:.7}@media screen and (max-width:100%){textarea[_ngcontent-%COMP%]{width:100%}}.start-at[_ngcontent-%COMP%], .stop-at[_ngcontent-%COMP%]{width:300px;display:flex;align-items:center}.start-at[_ngcontent-%COMP%]   my-timestamp-input[_ngcontent-%COMP%], .stop-at[_ngcontent-%COMP%]   my-timestamp-input[_ngcontent-%COMP%]{margin-left:10px}.screenratio[_ngcontent-%COMP%]{position:relative;height:0;width:100%;padding-top:56%}.screenratio[_ngcontent-%COMP%]     iframe, .screenratio[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0}"]}),e})()},u3oV:function(e,t,r){"use strict";var n=r("twO/"),o=r("fywt"),i=r("MKnB"),a=r("TnHx");t.a=function(e,t){if(null==e)return{};var r=Object(n.a)(Object(a.a)(e),function(e){return[e]});return t=Object(o.a)(t),Object(i.a)(e,r,function(e,r){return t(e,r[0])})}},xHIW:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=r("xMQD");class o{constructor(e){this.byAccount=new n.a(e.byAccount),this.blockedAccount=new n.a(e.blockedAccount),this.createdAt=e.createdAt}}}}]);